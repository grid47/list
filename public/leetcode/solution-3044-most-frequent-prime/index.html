<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 3044: Most Frequent Prime | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 3044: Most Frequent Prime">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 3044: Most Frequent Prime in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/solution-3044-most-frequent-prime/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 3044: Most Frequent Prime">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 3044: Most Frequent Prime in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-01-07T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Array">
    <meta property="article:tag" content="Hash Table">
    <meta property="article:tag" content="Math">
    <meta property="article:tag" content="Matrix">
    <meta property="article:tag" content="Counting">
    <meta property="article:tag" content="Enumeration">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.a3d5489836b19de22a81ddc6bd21c17547d07529e67b266427378a04fa3ea727.css" integrity="sha256-o9VImDaxneIqgd3GvSHBdUfQdSnmeyZkJzeKBPo&#43;pyc=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="mainheading">
    <h1 class="sitetitle">grid47</h1>
    <p class="lead">
         Blog by grid47
    </p>
</div><div class="main-content">
        
        <div class="container">
            <div class="row">
                
                <div class="col-md-2 pl-0"><div class="share sticky-top sticky-top-offset">
    <p>Share</p>
    <ul>
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://twitter.com/intent/tweet?text=Leetcode%203044%3a%20Most%20Frequent%20Prime&url=http%3a%2f%2flocalhost%3a1313%2fleetcode%2fsolution-3044-most-frequent-prime%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=435');return false;">
        <i class="fab fa-twitter"></i>
        </a>
        </li>
        
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://facebook.com/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fleetcode%2fsolution-3044-most-frequent-prime%2f" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
        <i class="fab fa-facebook-f"></i>
        </a>
        </li>

        <li class="ml-1 mr-1">
        <a target="_blank" href="https://www.xing.com/spi/shares/new?url=http%3a%2f%2flocalhost%3a1313%2fleetcode%2fsolution-3044-most-frequent-prime%2f" onclick="window.open(this.href, 'xing-share', 'width=550,height=435');return false;">
        <i class="fab fa-xing"></i>
        </a>
        </li>        
    </ul>

    
</div>
</div>
                                
                <div class="col-md-9 flex-first flex-md-unordered">
                    <div class="mainheading">
                        	
                        
                        
                        
                        <div class="row post-top-meta">
                            <div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0 md-nopad-right">
                                <img class="author-thumb" src="/images/logo.png" alt="grid47">
                            </div>
                            <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left md-nopad-left">
                                <a target="_blank" class="link-dark">grid47</a><br>
                                <span class="author-description">
                                    Exploring patterns and algorithms<br>
                                    <i class="far fa-star"></i>
                                    Jan 7, 2024
                                    <i class="far fa-clock clock"></i>
                                    7 min read
                                </span>					
                            </div>
                        </div>			
                        	
                        
                                                
                        
                        <h1 class="posttitle">Leetcode 3044: Most Frequent Prime</h1> 
                    </div>

                    
                    
                    
                    

                    
                    <div class="article-post">
                        <hr>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode2571s0hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">char</span> sieve[<span style="color:#666">1000001</span>] <span style="color:#666">=</span> {};
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">Solution</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> dx[<span style="color:#666">8</span>] <span style="color:#666">=</span> {<span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> dy[<span style="color:#666">8</span>] <span style="color:#666">=</span> {<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">make</span>() {
</span></span><span style="display:flex;"><span>        sieve[<span style="color:#666">1</span>] <span style="color:#666">=</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">2</span>; i <span style="color:#666">&lt;</span> <span style="color:#666">1000001</span>; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span> (<span style="color:#666">!</span>sieve[i]) <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">int</span> j <span style="color:#666">=</span> <span style="color:#666">2</span><span style="color:#666">*</span>i; j <span style="color:#666">&lt;</span> <span style="color:#666">1000001</span>; j <span style="color:#666">+=</span> i) sieve[j] <span style="color:#666">=</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } 
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">mostFrequentPrime</span>(vector<span style="color:#666">&lt;</span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;&amp;</span> mat) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span> (sieve[<span style="color:#666">1</span>] <span style="color:#666">==</span> <span style="color:#666">0</span>) make();
</span></span><span style="display:flex;"><span>        map<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, <span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> freq;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> mat.size(); i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">int</span> j <span style="color:#666">=</span> <span style="color:#666">0</span>; j <span style="color:#666">&lt;</span> mat[i].size(); j<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">int</span> k <span style="color:#666">=</span> <span style="color:#666">0</span>; k <span style="color:#666">&lt;</span> <span style="color:#666">8</span>; k<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#0b0;font-weight:bold">int</span> a <span style="color:#666">=</span> i, b <span style="color:#666">=</span> j;
</span></span><span style="display:flex;"><span>                    <span style="color:#0b0;font-weight:bold">int</span> cur <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#a2f;font-weight:bold">while</span> (a <span style="color:#666">&gt;=</span> <span style="color:#666">0</span> <span style="color:#666">&amp;&amp;</span> b <span style="color:#666">&gt;=</span> <span style="color:#666">0</span> <span style="color:#666">&amp;&amp;</span> a <span style="color:#666">&lt;</span> mat.size() <span style="color:#666">&amp;&amp;</span> b <span style="color:#666">&lt;</span> mat[i].size()) {
</span></span><span style="display:flex;"><span>                        cur <span style="color:#666">*=</span> <span style="color:#666">10</span>;
</span></span><span style="display:flex;"><span>                        cur <span style="color:#666">+=</span> mat[a][b];
</span></span><span style="display:flex;"><span>                        <span style="color:#a2f;font-weight:bold">if</span>(cur<span style="color:#666">&gt;</span><span style="color:#666">10</span> <span style="color:#666">&amp;&amp;</span> sieve[cur] <span style="color:#666">==</span> <span style="color:#666">0</span>) freq[cur]<span style="color:#666">++</span>;
</span></span><span style="display:flex;"><span>                        a <span style="color:#666">+=</span> dx[k]; b <span style="color:#666">+=</span> dy[k];
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> mx <span style="color:#666">=</span> <span style="color:#666">-</span><span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> ans <span style="color:#666">=</span> <span style="color:#666">-</span><span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#a2f;font-weight:bold">auto</span> <span style="color:#a0a000">i</span> : freq) {
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(i.second <span style="color:#666">&gt;=</span> mx) {
</span></span><span style="display:flex;"><span>                ans <span style="color:#666">=</span> i.first;
</span></span><span style="display:flex;"><span>                mx <span style="color:#666">=</span> i.second;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> ans;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};</span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement:</h3>
<p>The goal of this problem is to find the most frequent prime number formed by traversing the elements of a 2D grid <code>mat</code>. A prime number is formed by traversing the grid in any of the 8 possible directions: up-right, right, down-right, down-left, left, up-left, up, and down. The direction of traversal starts from any element, and as you traverse, you form a number by concatenating the elements of the grid. After all valid prime numbers are formed, the task is to return the prime number that appears most frequently in all directions. If there is a tie, return the smallest prime number.</p>
<h3 id="approach">Approach:</h3>
<p>To solve this problem efficiently, we need to consider the following approach:</p>
<ol>
<li>
<p><strong>Prime Number Calculation (Sieve of Eratosthenes):</strong></p>
<ul>
<li>First, we need to identify prime numbers. Given the potential large size of the numbers formed by grid elements, we use the <strong>Sieve of Eratosthenes</strong> to mark all prime numbers up to 1,000,000 (since the grid values are limited to the range of integers). We only need to check for primes in the range of numbers that can be formed by up to 6 digits (as the grid elements are integers and we&rsquo;re concatenating them in multiple directions).</li>
</ul>
</li>
<li>
<p><strong>Grid Traversal:</strong></p>
<ul>
<li>For each element in the grid, we need to traverse in all 8 possible directions. As we traverse, we will form numbers by concatenating the digits of the grid. If a valid prime number is formed, we update its frequency in a frequency map.</li>
</ul>
</li>
<li>
<p><strong>Map of Prime Frequency:</strong></p>
<ul>
<li>For each valid prime number found during the traversal, we store the frequency of its occurrence in a map (or hash map). After all grid cells have been traversed and all possible prime numbers are formed, the prime number that appears the most times in the grid is returned.</li>
</ul>
</li>
<li>
<p><strong>Final Output:</strong></p>
<ul>
<li>We return the prime number with the highest frequency. In case of a tie, the smallest prime number among them is returned.</li>
</ul>
</li>
</ol>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step):</h3>
<h4 id="step-1-sieve-of-eratosthenes">Step 1: Sieve of Eratosthenes</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">char</span> sieve[<span style="color:#666">1000001</span>] <span style="color:#666">=</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">make</span>() {
</span></span><span style="display:flex;"><span>    sieve[<span style="color:#666">1</span>] <span style="color:#666">=</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">2</span>; i <span style="color:#666">&lt;</span> <span style="color:#666">1000001</span>; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span> (<span style="color:#666">!</span>sieve[i]) {
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">int</span> j <span style="color:#666">=</span> <span style="color:#666">2</span><span style="color:#666">*</span>i; j <span style="color:#666">&lt;</span> <span style="color:#666">1000001</span>; j <span style="color:#666">+=</span> i) {
</span></span><span style="display:flex;"><span>                sieve[j] <span style="color:#666">=</span> <span style="color:#666">1</span>; <span style="color:#080;font-style:italic">// Marking non-primes
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>We create a sieve array of size <code>1,000,001</code> (since the numbers we need to consider can go up to 6 digits).</li>
<li>The <code>make()</code> function initializes the sieve array. If a number <code>i</code> is found to be prime (i.e., <code>sieve[i]</code> is 0), we mark all its multiples as non-prime by setting <code>sieve[j]</code> to 1.</li>
<li>We start from <code>i = 2</code> and mark all multiples of <code>i</code> as non-prime. This way, at the end of the process, all prime numbers will have <code>sieve[i] = 0</code>.</li>
</ul>
<h4 id="step-2-directions-for-grid-traversal">Step 2: Directions for Grid Traversal</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> dx[<span style="color:#666">8</span>] <span style="color:#666">=</span> {<span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>};
</span></span><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> dy[<span style="color:#666">8</span>] <span style="color:#666">=</span> {<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>};
</span></span></code></pre></div><ul>
<li>These arrays represent the 8 possible directions for traversal: down-right, right, up-right, up-left, left, down-left, up, and down.</li>
<li><code>dx[i]</code> and <code>dy[i]</code> represent the change in the row and column indices respectively for the <code>i</code>th direction.</li>
</ul>
<h4 id="step-3-traversing-the-grid-and-forming-numbers">Step 3: Traversing the Grid and Forming Numbers</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> mat.size(); i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">int</span> j <span style="color:#666">=</span> <span style="color:#666">0</span>; j <span style="color:#666">&lt;</span> mat[i].size(); j<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">int</span> k <span style="color:#666">=</span> <span style="color:#666">0</span>; k <span style="color:#666">&lt;</span> <span style="color:#666">8</span>; k<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#0b0;font-weight:bold">int</span> a <span style="color:#666">=</span> i, b <span style="color:#666">=</span> j;
</span></span><span style="display:flex;"><span>            <span style="color:#0b0;font-weight:bold">int</span> cur <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">while</span> (a <span style="color:#666">&gt;=</span> <span style="color:#666">0</span> <span style="color:#666">&amp;&amp;</span> b <span style="color:#666">&gt;=</span> <span style="color:#666">0</span> <span style="color:#666">&amp;&amp;</span> a <span style="color:#666">&lt;</span> mat.size() <span style="color:#666">&amp;&amp;</span> b <span style="color:#666">&lt;</span> mat[i].size()) {
</span></span><span style="display:flex;"><span>                cur <span style="color:#666">*=</span> <span style="color:#666">10</span>;
</span></span><span style="display:flex;"><span>                cur <span style="color:#666">+=</span> mat[a][b];
</span></span><span style="display:flex;"><span>                <span style="color:#a2f;font-weight:bold">if</span> (cur <span style="color:#666">&gt;</span> <span style="color:#666">10</span> <span style="color:#666">&amp;&amp;</span> sieve[cur] <span style="color:#666">==</span> <span style="color:#666">0</span>) freq[cur]<span style="color:#666">++</span>;
</span></span><span style="display:flex;"><span>                a <span style="color:#666">+=</span> dx[k]; b <span style="color:#666">+=</span> dy[k];
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>This part of the code is responsible for iterating over each cell in the matrix <code>mat</code> and checking all 8 possible directions from that cell.</li>
<li>For each direction <code>k</code>, we start at the current cell <code>(i, j)</code> and attempt to move in the direction defined by <code>dx[k]</code> and <code>dy[k]</code>. During the traversal, we concatenate the digits of the grid to form a number (<code>cur</code>).</li>
<li>If the formed number is greater than 10 and is prime (i.e., <code>sieve[cur] == 0</code>), we increase its frequency in the <code>freq</code> map.</li>
<li>The condition <code>cur &gt; 10</code> ensures that we only count numbers with more than one digit, preventing single-digit numbers from being included in the prime frequency count.</li>
</ul>
<h4 id="step-4-finding-the-most-frequent-prime">Step 4: Finding the Most Frequent Prime</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> mx <span style="color:#666">=</span> <span style="color:#666">-</span><span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> ans <span style="color:#666">=</span> <span style="color:#666">-</span><span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#a2f;font-weight:bold">auto</span> <span style="color:#a0a000">i</span> : freq) {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">if</span> (i.second <span style="color:#666">&gt;=</span> mx) {
</span></span><span style="display:flex;"><span>        ans <span style="color:#666">=</span> i.first;
</span></span><span style="display:flex;"><span>        mx <span style="color:#666">=</span> i.second;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">return</span> ans;
</span></span></code></pre></div><ul>
<li>After all numbers have been processed, we need to determine the prime number with the highest frequency.</li>
<li>We iterate over the <code>freq</code> map, which contains the prime numbers as keys and their respective counts as values.</li>
<li>If we find a prime number with a higher frequency (<code>i.second &gt;= mx</code>), we update <code>ans</code> to this prime and set <code>mx</code> to the new maximum frequency.</li>
<li>Finally, we return the prime number with the highest frequency.</li>
</ul>
<h3 id="time-complexity">Time Complexity:</h3>
<ol>
<li>
<p><strong>Sieve of Eratosthenes:</strong></p>
<ul>
<li>The sieve function runs in <code>O(n log log n)</code> where <code>n</code> is <code>1,000,000</code>. This is efficient for marking prime numbers up to <code>10^6</code>.</li>
</ul>
</li>
<li>
<p><strong>Grid Traversal:</strong></p>
<ul>
<li>We are iterating over each cell of the matrix, and for each cell, we check all 8 directions. For each direction, we can traverse a maximum of <code>min(rows, cols)</code> steps before going out of bounds. In the worst case, this can lead to checking all cells in the grid, giving us a time complexity of <code>O(rows * cols * min(rows, cols))</code>.</li>
</ul>
</li>
<li>
<p><strong>Frequency Calculation:</strong></p>
<ul>
<li>The frequency map <code>freq</code> contains prime numbers. Since we are only interested in numbers up to <code>10^6</code>, the size of the map will be limited. Finding the maximum frequency and determining the most frequent prime will take <code>O(k)</code> time, where <code>k</code> is the number of primes found.</li>
</ul>
</li>
</ol>
<p>Thus, the overall time complexity is dominated by the grid traversal and sieve generation, resulting in <code>O(n log log n + rows * cols * min(rows, cols))</code>.</p>
<h3 id="space-complexity">Space Complexity:</h3>
<ul>
<li>The space complexity is primarily determined by the sieve array, which takes <code>O(10^6)</code> space, and the frequency map, which stores the prime numbers formed. Thus, the space complexity is <code>O(n + rows * cols)</code> where <code>n</code> is the size of the sieve array, and <code>rows * cols</code> is the space required for storing frequencies.</li>
</ul>
<h3 id="conclusion">Conclusion:</h3>
<p>This solution efficiently finds the most frequent prime number formed from a 2D grid by using the Sieve of Eratosthenes for prime detection and exploring all 8 possible directions from each grid cell to form numbers. The result is the prime number that appears most frequently in the grid. The approach ensures optimal performance for large inputs, making it suitable for problems with large grid sizes.</p>
<p><a href="https://leetcode.com/problems/most-frequent-prime/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/vyLo_FMR3IU?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

                    </div>
                    
                    
                    <div class="after-post-tags">
                        <ul class="tags">
                        
                        <li>
                        <a href="/tags/array">Array</a>
                        </li>
                        
                        <li>
                        <a href="/tags/hash-table">Hash Table</a>
                        </li>
                        
                        <li>
                        <a href="/tags/math">Math</a>
                        </li>
                        
                        <li>
                        <a href="/tags/matrix">Matrix</a>
                        </li>
                        
                        <li>
                        <a href="/tags/counting">Counting</a>
                        </li>
                        
                        <li>
                        <a href="/tags/enumeration">Enumeration</a>
                        </li>
                        
                        <li>
                        <a href="/tags/number-theory">Number Theory</a>
                        </li>
                        
                        </ul>
                    </div>
                    
                    
                    
                    <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
                    
                        <a class="d-block col-md-6" href="http://localhost:1313/leetcode/solution-3043-find-the-length-of-the-longest-common-prefix/"> &laquo; Leetcode 3043: Find the Length of the Longest Common Prefix</a>
                    
                    
                        <a class="d-block col-md-6 text-lg-right" href="http://localhost:1313/leetcode/solution-3046-split-the-array/">Leetcode 3046: Split the Array &raquo;</a>
                    
                    <div class="clearfix"></div>
                    </div>
                    
                </div>
                
            </div>
        </div>
        
        
    </div>


            </div>
<div class="jumbotron fortags">
	<div class="d-md-flex h-100">
		<div class="col-md-4 transpdark align-self-center text-center h-100">
			<div class="d-md-flex align-items-center justify-content-center h-100">
				<h2 class="d-md-block d-none align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">â†’</span></h2>
			</div>
		</div>
		<div class="col-md-8 p-5 align-self-center text-center">
			
			<a class="mt-1 mb-1" href="/tags/array">array</a>
			
			<a class="mt-1 mb-1" href="/tags/backtracking">backtracking</a>
			
			<a class="mt-1 mb-1" href="/tags/binary-indexed-tree">binary indexed tree</a>
			
			<a class="mt-1 mb-1" href="/tags/binary-search">binary search</a>
			
			<a class="mt-1 mb-1" href="/tags/binary-search-tree">binary search tree</a>
			
			<a class="mt-1 mb-1" href="/tags/binary-tree">binary tree</a>
			
			<a class="mt-1 mb-1" href="/tags/bit-manipulation">bit manipulation</a>
			
			<a class="mt-1 mb-1" href="/tags/bitmask">bitmask</a>
			
			<a class="mt-1 mb-1" href="/tags/brainteaser">brainteaser</a>
			
			<a class="mt-1 mb-1" href="/tags/breadth-first-search">breadth-first search</a>
			
			<a class="mt-1 mb-1" href="/tags/bucket-sort">bucket sort</a>
			
			<a class="mt-1 mb-1" href="/tags/combinatorics">combinatorics</a>
			
			<a class="mt-1 mb-1" href="/tags/concurrency">concurrency</a>
			
			<a class="mt-1 mb-1" href="/tags/counting">counting</a>
			
			<a class="mt-1 mb-1" href="/tags/counting-sort">counting sort</a>
			
			<a class="mt-1 mb-1" href="/tags/data-stream">data stream</a>
			
			<a class="mt-1 mb-1" href="/tags/database">database</a>
			
			<a class="mt-1 mb-1" href="/tags/depth-first-search">depth-first search</a>
			
			<a class="mt-1 mb-1" href="/tags/design">design</a>
			
			<a class="mt-1 mb-1" href="/tags/divide-and-conquer">divide and conquer</a>
			
			<a class="mt-1 mb-1" href="/tags/doubly-linked-list">doubly-linked list</a>
			
			<a class="mt-1 mb-1" href="/tags/dynamic-programming">dynamic programming</a>
			
			<a class="mt-1 mb-1" href="/tags/enumeration">enumeration</a>
			
			<a class="mt-1 mb-1" href="/tags/game-theory">game theory</a>
			
			<a class="mt-1 mb-1" href="/tags/geometry">geometry</a>
			
			<a class="mt-1 mb-1" href="/tags/graph">graph</a>
			
			<a class="mt-1 mb-1" href="/tags/greedy">greedy</a>
			
			<a class="mt-1 mb-1" href="/tags/hash-function">hash function</a>
			
			<a class="mt-1 mb-1" href="/tags/hash-table">hash table</a>
			
			<a class="mt-1 mb-1" href="/tags/heap-priority-queue">heap (priority queue)</a>
			
			<a class="mt-1 mb-1" href="/tags/interactive">interactive</a>
			
			<a class="mt-1 mb-1" href="/tags/iterator">iterator</a>
			
			<a class="mt-1 mb-1" href="/tags/linked-list">linked list</a>
			
			<a class="mt-1 mb-1" href="/tags/math">math</a>
			
			<a class="mt-1 mb-1" href="/tags/matrix">matrix</a>
			
			<a class="mt-1 mb-1" href="/tags/memoization">memoization</a>
			
			<a class="mt-1 mb-1" href="/tags/minimum-spanning-tree">minimum spanning tree</a>
			
			<a class="mt-1 mb-1" href="/tags/monotonic-queue">monotonic queue</a>
			
			<a class="mt-1 mb-1" href="/tags/monotonic-stack">monotonic stack</a>
			
			<a class="mt-1 mb-1" href="/tags/number-theory">number theory</a>
			
			<a class="mt-1 mb-1" href="/tags/ordered-set">ordered set</a>
			
			<a class="mt-1 mb-1" href="/tags/prefix-sum">prefix sum</a>
			
			<a class="mt-1 mb-1" href="/tags/probability-and-statistics">probability and statistics</a>
			
			<a class="mt-1 mb-1" href="/tags/queue">queue</a>
			
			<a class="mt-1 mb-1" href="/tags/quickselect">quickselect</a>
			
			<a class="mt-1 mb-1" href="/tags/radix-sort">radix sort</a>
			
			<a class="mt-1 mb-1" href="/tags/randomized">randomized</a>
			
			<a class="mt-1 mb-1" href="/tags/recursion">recursion</a>
			
			<a class="mt-1 mb-1" href="/tags/reservoir-sampling">reservoir sampling</a>
			
			<a class="mt-1 mb-1" href="/tags/rolling-hash">rolling hash</a>
			
			<a class="mt-1 mb-1" href="/tags/segment-tree">segment tree</a>
			
			<a class="mt-1 mb-1" href="/tags/shortest-path">shortest path</a>
			
			<a class="mt-1 mb-1" href="/tags/simulation">simulation</a>
			
			<a class="mt-1 mb-1" href="/tags/sliding-window">sliding window</a>
			
			<a class="mt-1 mb-1" href="/tags/sorting">sorting</a>
			
			<a class="mt-1 mb-1" href="/tags/stack">stack</a>
			
			<a class="mt-1 mb-1" href="/tags/string">string</a>
			
			<a class="mt-1 mb-1" href="/tags/string-matching">string matching</a>
			
			<a class="mt-1 mb-1" href="/tags/topological-sort">topological sort</a>
			
			<a class="mt-1 mb-1" href="/tags/tree">tree</a>
			
			<a class="mt-1 mb-1" href="/tags/trie">trie</a>
			
			<a class="mt-1 mb-1" href="/tags/two-pointers">two pointers</a>
			
			<a class="mt-1 mb-1" href="/tags/union-find">union find</a>
			
		</div>
	</div>
</div>

<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">    
                <a target="_blank" rel="noopener" href="https://www.wowthemes.net">Mediumish Theme</a> by WowThemes.net
            </div>
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
