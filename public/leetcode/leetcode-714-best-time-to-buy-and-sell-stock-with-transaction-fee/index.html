<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 714: Best Time to Buy and Sell Stock with Transaction Fee | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 714: Best Time to Buy and Sell Stock with Transaction Fee">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 714: Best Time to Buy and Sell Stock with Transaction Fee in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/leetcode-714-best-time-to-buy-and-sell-stock-with-transaction-fee/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 714: Best Time to Buy and Sell Stock with Transaction Fee">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 714: Best Time to Buy and Sell Stock with Transaction Fee in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-08-27T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Array">
    <meta property="article:tag" content="Dynamic Programming">
    <meta property="article:tag" content="Greedy">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.ced6b291f6520a092efe4c87ca4fc7047e1c3174b10653f78e13ca06f0bb6abf.css" integrity="sha256-ztaykfZSCgku/kyHyk/HBH4cMXSxBlP3jhPKBvC7ar8=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
	<link rel="stylesheet" href="/css/head.css" integrity="" crossorigin="anonymous" media="screen">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="main-content">

<div class="container">
	<div class="row">
        <div class="col-md-1"></div>
		<div class="col-md-10">
			<div class="mainheading">
				<h1 class="posttitle">Leetcode 714: Best Time to Buy and Sell Stock with Transaction Fee</h1> 
            </div>
			<div class="article-post">
				<h2 id="hahahugoshortcode1268s0hbhb"><figure class="remote-image" style="text-align:center; margin: 0;">
    <div style="position: relative; width:900px; max-width:100%; padding-bottom:56.25%; overflow: hidden; border-radius:0px;">
      <img src="https://raw.githubusercontent.com/grid47/list-images/refs/heads/main/list/714.webp" 
           alt="A stock price chart where the best time to buy and sell is highlighted, with the optimal prices softly glowing." 
           style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;">
    </div>
    
      <figcaption style="font-size: 0.8em; font-weight: 300; color:#555; margin-top: 4px; line-height: 1.2;">
        Solution to LeetCode 714: Best Time to Buy and Sell Stock with Transaction Fee Problem
      </figcaption>
    
  </figure>
  </h2>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode1268s1hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">Solution</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> maxProfit(vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&amp;</span> prices, <span style="color:#0b0;font-weight:bold">int</span> fee) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span>(prices.size() <span style="color:#666">&lt;=</span> <span style="color:#666">1</span>) <span style="color:#a2f;font-weight:bold">return</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> days <span style="color:#666">=</span> prices.size();
</span></span><span style="display:flex;"><span>        vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> buy(days, <span style="color:#666">0</span>), sell(days, <span style="color:#666">0</span>);
</span></span><span style="display:flex;"><span>        buy[<span style="color:#666">0</span>]<span style="color:#666">=</span> <span style="color:#666">-</span>prices[<span style="color:#666">0</span>]<span style="color:#666">-</span>fee;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">1</span>; i <span style="color:#666">&lt;</span> days; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            buy[i] <span style="color:#666">=</span> max(buy[i <span style="color:#666">-</span><span style="color:#666">1</span>], sell[i <span style="color:#666">-</span><span style="color:#666">1</span>]<span style="color:#666">-</span>prices[i]<span style="color:#666">-</span>fee);
</span></span><span style="display:flex;"><span>            sell[i] <span style="color:#666">=</span> max(sell[i <span style="color:#666">-</span><span style="color:#666">1</span>], buy[i <span style="color:#666">-</span> <span style="color:#666">1</span>]<span style="color:#666">+</span>prices[i]);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> sell[days <span style="color:#666">-</span> <span style="color:#666">1</span>];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};</span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement</h3>
<p>The problem is about maximizing profit from a series of stock prices, where each price is given as an array <code>prices</code>. The goal is to determine the maximum profit that can be earned by completing multiple transactions, but with the restriction that each transaction incurs a fee (<code>fee</code>).</p>
<p>A transaction involves buying one stock and selling it later. The challenge is to determine the maximum profit that can be obtained by performing any number of transactions, subject to the fee on each sale.</p>
<h3 id="approach">Approach</h3>
<p>To solve this problem optimally, we can use <strong>dynamic programming</strong> (DP). The idea is to track two states for each day:</p>
<ul>
<li><strong>Buy state</strong>: The maximum profit if we bought the stock on that day (or carried over from a previous transaction).</li>
<li><strong>Sell state</strong>: The maximum profit if we sold the stock on that day.</li>
</ul>
<p>We can use two arrays:</p>
<ul>
<li><code>buy[i]</code>: Maximum profit on day <code>i</code> if we have bought the stock.</li>
<li><code>sell[i]</code>: Maximum profit on day <code>i</code> if we have sold the stock.</li>
</ul>
<p>The two core transitions are:</p>
<ol>
<li>
<p><strong>Buy State</strong>: On day <code>i</code>, we can either:</p>
<ul>
<li>Stay in the same &ldquo;buy&rdquo; state (carry over from the previous day).</li>
<li>Buy the stock on day <code>i</code> after selling the stock on day <code>i-1</code>. This means we subtract the stock price and the fee from the profit made by selling on day <code>i-1</code>.</li>
</ul>
</li>
<li>
<p><strong>Sell State</strong>: On day <code>i</code>, we can either:</p>
<ul>
<li>Stay in the same &ldquo;sell&rdquo; state (carry over the previous day&rsquo;s profit from selling).</li>
<li>Sell the stock on day <code>i</code> after buying it on day <code>i-1</code>. This adds the price of the stock on day <code>i</code> to the profit made by buying on day <code>i-1</code>.</li>
</ul>
</li>
</ol>
<p>By maintaining these two states, we can compute the maximum profit possible by day <code>n</code> (the last day).</p>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step)</h3>
<p>Hereâ€™s the detailed step-by-step breakdown of the solution:</p>
<ol>
<li>
<p><strong>Base Case</strong>:</p>
<ul>
<li>First, we check if the length of the <code>prices</code> array is less than or equal to 1. If so, we return 0 because no transaction can be made. This avoids unnecessary computations for edge cases:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">if</span>(prices.size() <span style="color:#666">&lt;=</span> <span style="color:#666">1</span>) <span style="color:#a2f;font-weight:bold">return</span> <span style="color:#666">0</span>;
</span></span></code></pre></div></li>
<li>
<p><strong>Initialization</strong>:</p>
<ul>
<li>We initialize the number of days (<code>days</code>) to the length of the <code>prices</code> array.</li>
<li>We create two arrays <code>buy</code> and <code>sell</code> of size <code>days</code> initialized to 0. These will hold the maximum profit on each day for the respective states (buy and sell):</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> buy(days, <span style="color:#666">0</span>), sell(days, <span style="color:#666">0</span>);
</span></span></code></pre></div></li>
<li>
<p><strong>Initial Values</strong>:</p>
<ul>
<li>On day 0, if we buy the stock, our profit is negative because we spent money on buying the stock, and we also incur the fee. Hence, we set:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>buy[<span style="color:#666">0</span>] <span style="color:#666">=</span> <span style="color:#666">-</span>prices[<span style="color:#666">0</span>] <span style="color:#666">-</span> fee;
</span></span></code></pre></div></li>
<li>
<p><strong>Dynamic Programming Transition</strong>:</p>
<ul>
<li>From day 1 onwards, we compute the <code>buy</code> and <code>sell</code> values for each day using the previously mentioned transitions:</li>
<li>The <code>buy[i]</code> on day <code>i</code> can either be:
<ul>
<li>The previous day&rsquo;s <code>buy[i-1]</code> value (i.e., carrying over the previous buy state).</li>
<li>Or the profit from selling on day <code>i-1</code> (i.e., <code>sell[i-1]</code>), minus the cost of buying on day <code>i</code> and the transaction fee.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>buy[i] <span style="color:#666">=</span> max(buy[i<span style="color:#666">-</span><span style="color:#666">1</span>], sell[i<span style="color:#666">-</span><span style="color:#666">1</span>] <span style="color:#666">-</span> prices[i] <span style="color:#666">-</span> fee);
</span></span></code></pre></div></li>
<li>The <code>sell[i]</code> on day <code>i</code> can either be:
<ul>
<li>The previous day&rsquo;s <code>sell[i-1]</code> value (i.e., carrying over the previous sell state).</li>
<li>Or the profit from buying on day <code>i-1</code> (i.e., <code>buy[i-1]</code>), plus the price of selling on day <code>i</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>sell[i] <span style="color:#666">=</span> max(sell[i<span style="color:#666">-</span><span style="color:#666">1</span>], buy[i<span style="color:#666">-</span><span style="color:#666">1</span>] <span style="color:#666">+</span> prices[i]);
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Final Answer</strong>:</p>
<ul>
<li>After filling out the <code>buy</code> and <code>sell</code> arrays, the maximum profit that can be obtained by the last day is stored in <code>sell[days - 1]</code>. This is because the last action should be selling the stock, so the maximum profit will be in the <code>sell</code> state on the last day.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">return</span> sell[days <span style="color:#666">-</span> <span style="color:#666">1</span>];
</span></span></code></pre></div></li>
</ol>
<h3 id="complexity-analysis">Complexity Analysis</h3>
<ul>
<li>
<p><strong>Time Complexity</strong>:</p>
<ul>
<li>The algorithm iterates over the <code>prices</code> array once, performing constant-time operations for each element. Therefore, the time complexity is <strong>O(n)</strong>, where <code>n</code> is the number of days (length of the <code>prices</code> array). This is optimal for this type of problem.</li>
</ul>
</li>
<li>
<p><strong>Space Complexity</strong>:</p>
<ul>
<li>The space complexity is <strong>O(n)</strong> due to the two arrays <code>buy</code> and <code>sell</code>, each of size <code>n</code>. This space is required to store the maximum profit states for each day.</li>
</ul>
<p>If we wanted to optimize space further, we could use two variables instead of the arrays, reducing the space complexity to <strong>O(1)</strong>. However, the time complexity would remain <strong>O(n)</strong>.</p>
</li>
</ul>
<h3 id="conclusion">Conclusion</h3>
<p>This solution provides an efficient way to compute the maximum profit from stock transactions with a fee using dynamic programming. By maintaining the <code>buy</code> and <code>sell</code> states for each day, the algorithm computes the optimal solution in linear time. This is much more efficient than the brute-force approach, which would involve checking all possible subarrays or combinations of buy and sell days, leading to a higher time complexity.</p>
<p>The algorithm&rsquo;s simplicity and efficiency make it suitable for large input sizes, and it leverages dynamic programming to avoid redundant calculations. It ensures that we can handle complex scenarios such as fees on each transaction while still maintaining optimal performance.</p>
<p>In summary, the dynamic programming approach used here is optimal for the problem, ensuring that the solution is both time-efficient and space-efficient. This makes it ideal for solving real-world stock trading problems where performance and scalability are critical.</p>
<p><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-with-transaction-fee/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/HLr_OnShK4s?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

			</div>
		</div>
        <div class="col-md-1"></div>
	</div>
</div>

</div>


            </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
