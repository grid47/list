<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 2961: Double Modular Exponentiation | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 2961: Double Modular Exponentiation">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 2961: Double Modular Exponentiation in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/leetcode-2961-double-modular-exponentiation/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 2961: Double Modular Exponentiation">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 2961: Double Modular Exponentiation in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-01-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Array">
    <meta property="article:tag" content="Math">
    <meta property="article:tag" content="Simulation">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.ced6b291f6520a092efe4c87ca4fc7047e1c3174b10653f78e13ca06f0bb6abf.css" integrity="sha256-ztaykfZSCgku/kyHyk/HBH4cMXSxBlP3jhPKBvC7ar8=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
	<link rel="stylesheet" href="/css/head.css" integrity="" crossorigin="anonymous" media="screen">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="main-content">

<div class="container">
	<div class="row">
        <div class="col-md-1"></div>
		<div class="col-md-10">
			<div class="mainheading">
				<h1 class="posttitle">Leetcode 2961: Double Modular Exponentiation</h1> 
            </div>
			<div class="article-post">
				<hr>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode1035s0hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">Solution</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> power(<span style="color:#0b0;font-weight:bold">long</span> <span style="color:#0b0;font-weight:bold">long</span> b, <span style="color:#0b0;font-weight:bold">long</span> <span style="color:#0b0;font-weight:bold">long</span> p, <span style="color:#0b0;font-weight:bold">int</span> m){
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">if</span>(p <span style="color:#666">&lt;=</span> <span style="color:#666">0</span>) <span style="color:#a2f;font-weight:bold">return</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">long</span> <span style="color:#0b0;font-weight:bold">long</span> t <span style="color:#666">=</span> power(b, p<span style="color:#666">/</span><span style="color:#666">2</span>, m);
</span></span><span style="display:flex;"><span>    t <span style="color:#666">=</span> ((t <span style="color:#666">*</span> t)<span style="color:#666">%</span>m);
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">return</span> (p<span style="color:#666">%</span><span style="color:#666">2</span>)<span style="color:#666">?</span>(t <span style="color:#666">*</span> b)<span style="color:#666">%</span><span style="color:#a0a000">m</span> : t;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> getGoodIndices(vector<span style="color:#666">&lt;</span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;&amp;</span> v, <span style="color:#0b0;font-weight:bold">int</span> target) {
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> ans;
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> v.size(); <span style="color:#666">++</span>i){
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">long</span> <span style="color:#0b0;font-weight:bold">long</span> a <span style="color:#666">=</span> v[i][<span style="color:#666">0</span>]<span style="color:#666">%</span><span style="color:#666">10</span>, b <span style="color:#666">=</span> v[i][<span style="color:#666">1</span>], c <span style="color:#666">=</span> v[i][<span style="color:#666">2</span>], m <span style="color:#666">=</span> v[i][<span style="color:#666">3</span>], t <span style="color:#666">=</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>        t <span style="color:#666">=</span> power(a, b, <span style="color:#666">10</span>);
</span></span><span style="display:flex;"><span>        t <span style="color:#666">=</span> power(t, c, m);
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span>(t <span style="color:#666">==</span> target) ans.push_back(i);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">return</span> ans;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>};</span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement:</h3>
<p>Given a matrix <code>v</code> where each row contains four integers <code>[a, b, c, m]</code>, the goal is to compute a value for each row using a modular exponentiation technique and check if the result equals a given <code>target</code>. If the result matches the target, the index of that row should be added to the result list. The computation involves two stages of exponentiation. The challenge lies in efficiently calculating large powers modulo <code>m</code> and ensuring that the results are correct without causing overflow or performance issues.</p>
<h3 id="approach">Approach:</h3>
<p>The problem involves calculating large powers using the modular exponentiation technique, which is a method to compute powers efficiently without directly multiplying the base multiple times. The key to solving this problem is the application of <strong>modular exponentiation</strong> to avoid overflow and compute the values in an efficient manner.</p>
<p><strong>Modular exponentiation</strong> is essential for this task because the numbers involved in exponentiation can grow very large, but we only need the result modulo <code>m</code>.</p>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step):</h3>
<p>Let&rsquo;s break down the code and its parts for a deeper understanding:</p>
<h4 id="1-modular-exponentiation-function-power">1. <strong>Modular Exponentiation Function (<code>power</code>)</strong>:</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">power</span>(<span style="color:#0b0;font-weight:bold">long</span> <span style="color:#0b0;font-weight:bold">long</span> b, <span style="color:#0b0;font-weight:bold">long</span> <span style="color:#0b0;font-weight:bold">long</span> p, <span style="color:#0b0;font-weight:bold">int</span> m) {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">if</span> (p <span style="color:#666">&lt;=</span> <span style="color:#666">0</span>) <span style="color:#a2f;font-weight:bold">return</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">long</span> <span style="color:#0b0;font-weight:bold">long</span> t <span style="color:#666">=</span> power(b, p <span style="color:#666">/</span> <span style="color:#666">2</span>, m);
</span></span><span style="display:flex;"><span>    t <span style="color:#666">=</span> ((t <span style="color:#666">*</span> t) <span style="color:#666">%</span> m);
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">return</span> (p <span style="color:#666">%</span> <span style="color:#666">2</span>) <span style="color:#666">?</span> (t <span style="color:#666">*</span> b) <span style="color:#666">%</span> <span style="color:#a0a000">m</span> : t;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>This function calculates <code>b^p % m</code> using <strong>recursive modular exponentiation</strong>.</li>
<li><strong>Base Case</strong>: If <code>p &lt;= 0</code>, return <code>1</code>. This handles the case when the exponent is zero or negative (in some contexts, negative exponents are defined as reciprocal).</li>
<li><strong>Recursive Step</strong>: We first recursively calculate <code>b^(p/2) % m</code> to reduce the problem size (using the divide-and-conquer approach). We then square the result to get <code>b^p % m</code>, and finally, we handle the case when <code>p</code> is odd by multiplying the result by <code>b</code> again.</li>
<li><strong>Efficiency</strong>: This method reduces the time complexity to <strong>O(log(p))</strong> instead of <strong>O(p)</strong>, which is a significant improvement when dealing with large exponents.</li>
</ul>
<h4 id="2-main-logic-loop-through-v">2. <strong>Main Logic (Loop through <code>v</code>)</strong>:</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> getGoodIndices(vector<span style="color:#666">&lt;</span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;&amp;</span> v, <span style="color:#0b0;font-weight:bold">int</span> target) {
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> ans;
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> v.size(); <span style="color:#666">++</span>i) {
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">long</span> <span style="color:#0b0;font-weight:bold">long</span> a <span style="color:#666">=</span> v[i][<span style="color:#666">0</span>] <span style="color:#666">%</span> <span style="color:#666">10</span>, b <span style="color:#666">=</span> v[i][<span style="color:#666">1</span>], c <span style="color:#666">=</span> v[i][<span style="color:#666">2</span>], m <span style="color:#666">=</span> v[i][<span style="color:#666">3</span>], t <span style="color:#666">=</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>        t <span style="color:#666">=</span> power(a, b, <span style="color:#666">10</span>);
</span></span><span style="display:flex;"><span>        t <span style="color:#666">=</span> power(t, c, m);
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span>(t <span style="color:#666">==</span> target) ans.push_back(i);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">return</span> ans;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>
<p><strong>Iteration over Rows</strong>: We iterate over each row of the input matrix <code>v</code>, where each row contains four elements <code>[a, b, c, m]</code>. These elements represent the base <code>a</code>, exponent <code>b</code>, the second exponent <code>c</code>, and modulus <code>m</code>, respectively.</p>
<ul>
<li>
<p><code>a % 10</code> ensures that we only consider the last digit of <code>a</code>, as the final result is only dependent on the last digit of the base <code>a</code> for the initial modular exponentiation.</p>
</li>
<li>
<p><strong>First Power Calculation</strong>: We calculate <code>a^b % 10</code> using the <code>power</code> function to find the result of raising <code>a</code> to the power <code>b</code> and taking the result modulo <code>10</code>. This step is equivalent to reducing the base <code>a</code> to a smaller value modulo <code>10</code> before moving on to the next stage.</p>
</li>
<li>
<p><strong>Second Power Calculation</strong>: The result of the first exponentiation, stored in <code>t</code>, is then raised to the power <code>c</code> modulo <code>m</code>. This is the second stage of exponentiation, which involves applying modular exponentiation to the result of the previous step.</p>
</li>
</ul>
</li>
<li>
<p><strong>Condition Check</strong>: After calculating <code>t</code>, the value is compared to the target. If they are equal, we add the current index <code>i</code> to the <code>ans</code> vector. This means that the index <code>i</code> corresponds to a row that produces the required result.</p>
</li>
<li>
<p><strong>Return Result</strong>: Once all rows are processed, the function returns the list of indices <code>ans</code> that satisfy the condition.</p>
</li>
</ul>
<h3 id="complexity-analysis">Complexity Analysis:</h3>
<h4 id="time-complexity">Time Complexity:</h4>
<ul>
<li><strong>Modular Exponentiation</strong>: The <code>power</code> function performs logarithmic work in terms of the exponent <code>p</code> (i.e., <strong>O(log p)</strong>), which ensures that the large exponents in the matrix <code>v</code> are handled efficiently.</li>
<li><strong>Iterating Over Rows</strong>: We iterate over each row in the matrix <code>v</code>, and for each row, we perform two modular exponentiations. Therefore, the total time complexity is the number of rows <code>n</code> times the complexity of calculating the powers, which is <strong>O(n * log p)</strong>, where <code>p</code> is the maximum exponent encountered in the input.</li>
<li><strong>Final Complexity</strong>: Assuming that the largest exponents <code>b</code> and <code>c</code> are bounded by some constant, the complexity can be simplified to <strong>O(n)</strong>, where <code>n</code> is the number of rows in <code>v</code>.</li>
</ul>
<h4 id="space-complexity">Space Complexity:</h4>
<ul>
<li>The space complexity of this solution is <strong>O(n)</strong> due to the storage required for the result vector <code>ans</code>, which stores the indices of the rows that produce the desired result.</li>
<li>The auxiliary space for the recursive calls in the <code>power</code> function is <strong>O(log p)</strong> due to the recursive depth required for modular exponentiation.</li>
</ul>
<h3 id="conclusion">Conclusion:</h3>
<p>This solution efficiently computes the required modular exponentiation and checks if the computed result matches the target. By using recursive modular exponentiation, the solution avoids overflow and provides a highly efficient method for handling large numbers. The time complexity is linear with respect to the number of rows, with logarithmic time complexity for each exponentiation, making the solution scalable for large inputs.</p>
<p>By following this approach, we achieve an optimized solution for computing powers modulo <code>m</code> and checking the results against a target, while keeping both time and space complexities in check.</p>
<p><a href="https://leetcode.com/problems/double-modular-exponentiation/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/I0NpbqgISas?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

			</div>
		</div>
        <div class="col-md-1"></div>
	</div>
</div>

</div>


            </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
