<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 528: Random Pick with Weight | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 528: Random Pick with Weight">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 528: Random Pick with Weight in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/leetcode-528-random-pick-with-weight/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 528: Random Pick with Weight">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 528: Random Pick with Weight in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-09-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Math">
    <meta property="article:tag" content="Binary Search">
    <meta property="article:tag" content="Prefix Sum">
    <meta property="article:tag" content="Randomized">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.ced6b291f6520a092efe4c87ca4fc7047e1c3174b10653f78e13ca06f0bb6abf.css" integrity="sha256-ztaykfZSCgku/kyHyk/HBH4cMXSxBlP3jhPKBvC7ar8=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
	<link rel="stylesheet" href="/css/head.css" integrity="" crossorigin="anonymous" media="screen">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="main-content">

<div class="container">
	<div class="row">
        <div class="col-md-1"></div>
		<div class="col-md-10">
			<div class="mainheading">
				<h1 class="posttitle">Leetcode 528: Random Pick with Weight</h1> 
            </div>
			<div class="article-post">
				<h2 id="hahahugoshortcode1181s0hbhb"><figure class="remote-image" style="text-align:center; margin: 0;">
    <div style="position: relative; width:900px; max-width:100%; padding-bottom:56.25%; overflow: hidden; border-radius:0px;">
      <img src="https://raw.githubusercontent.com/grid47/list-images/refs/heads/main/list/528.webp" 
           alt="A series of objects with different weights, each object softly glowing based on its probability of being picked." 
           style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;">
    </div>
    
      <figcaption style="font-size: 0.8em; font-weight: 300; color:#555; margin-top: 4px; line-height: 1.2;">
        Solution to LeetCode 528: Random Pick with Weight Problem
      </figcaption>
    
  </figure>
  </h2>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode1181s1hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">Solution</span> {
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> wc;
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    Solution(vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&amp;</span> w) {
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> n <span style="color:#666">=</span> w.size();
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">1</span>; i <span style="color:#666">&lt;</span> n; i<span style="color:#666">++</span>)
</span></span><span style="display:flex;"><span>            w[i] <span style="color:#666">+=</span> w[i <span style="color:#666">-</span> <span style="color:#666">1</span>];
</span></span><span style="display:flex;"><span>        wc <span style="color:#666">=</span> w;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">pickIndex</span>() {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> x <span style="color:#666">=</span> rand() <span style="color:#666">%</span> wc.back()<span style="color:#666">+</span><span style="color:#666">1</span>;<span style="color:#080;font-style:italic">//[(wc.size() - 1)];        
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>        <span style="color:#0b0;font-weight:bold">int</span> l <span style="color:#666">=</span> <span style="color:#666">0</span>, r <span style="color:#666">=</span> wc.size() <span style="color:#666">-</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">while</span>(l <span style="color:#666">&lt;</span> r) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#0b0;font-weight:bold">int</span> mid <span style="color:#666">=</span> l <span style="color:#666">+</span> (r <span style="color:#666">-</span> l) <span style="color:#666">/</span> <span style="color:#666">2</span>;            
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(wc[mid] <span style="color:#666">==</span> x) <span style="color:#a2f;font-weight:bold">return</span> mid;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(wc[mid] <span style="color:#666">&lt;</span> x) l <span style="color:#666">=</span> mid <span style="color:#666">+</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">else</span>            r <span style="color:#666">=</span> mid;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> l;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * Your Solution object will be instantiated and called as such:
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * Solution* obj = new Solution(w);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * int param_1 = obj-&gt;pickIndex();
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> */</span></span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement</h3>
<p>The task is to create a solution where each index of an input array <code>w</code> is chosen with a probability proportional to the value at that index. This requires building a mechanism to select indices according to weighted probabilities. Given an array of positive integers, we need a way to initialize a data structure that, when calling <code>pickIndex</code>, returns an index based on these weights.</p>
<h3 id="approach">Approach</h3>
<ol>
<li>
<p><strong>Prefix Sum Array</strong>:</p>
<ul>
<li>First, transform the input weights array <code>w</code> into a prefix sum array. In the prefix sum array, each element at index <code>i</code> will contain the sum of all weights from the start up to index <code>i</code>.</li>
<li>This transformation allows each index in the prefix sum array to represent cumulative probability bounds for selection.</li>
</ul>
</li>
<li>
<p><strong>Random Selection Using Binary Search</strong>:</p>
<ul>
<li>To pick an index with the appropriate weight, generate a random integer <code>x</code> within the range <code>[1, wc.back()]</code> where <code>wc.back()</code> represents the total sum of weights.</li>
<li>Using binary search, locate the smallest index in the prefix sum array <code>wc</code> where <code>wc[i] &gt;= x</code>. This index <code>i</code> represents the randomly selected index based on the weight.</li>
</ul>
</li>
</ol>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step)</h3>
<h4 id="step-1-initialize-the-prefix-sum-array">Step 1: Initialize the Prefix Sum Array</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Solution(vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&amp;</span> w) {
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> n <span style="color:#666">=</span> w.size();
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">1</span>; i <span style="color:#666">&lt;</span> n; i<span style="color:#666">++</span>)
</span></span><span style="display:flex;"><span>        w[i] <span style="color:#666">+=</span> w[i <span style="color:#666">-</span> <span style="color:#666">1</span>];
</span></span><span style="display:flex;"><span>    wc <span style="color:#666">=</span> w;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>This constructor takes an input weight array <code>w</code> and modifies it to be a prefix sum array.</li>
<li>By iterating from the second element, we update each element to hold the cumulative sum up to that point. This helps in determining probability boundaries, making it efficient to select indices in proportion to their weights.</li>
</ul>
<h4 id="step-2-generate-a-random-index-based-on-weights">Step 2: Generate a Random Index Based on Weights</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">pickIndex</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> x <span style="color:#666">=</span> rand() <span style="color:#666">%</span> wc.back() <span style="color:#666">+</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> l <span style="color:#666">=</span> <span style="color:#666">0</span>, r <span style="color:#666">=</span> wc.size() <span style="color:#666">-</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">while</span>(l <span style="color:#666">&lt;</span> r) {
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> mid <span style="color:#666">=</span> l <span style="color:#666">+</span> (r <span style="color:#666">-</span> l) <span style="color:#666">/</span> <span style="color:#666">2</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span>(wc[mid] <span style="color:#666">==</span> x) <span style="color:#a2f;font-weight:bold">return</span> mid;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span>(wc[mid] <span style="color:#666">&lt;</span> x) l <span style="color:#666">=</span> mid <span style="color:#666">+</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">else</span>            r <span style="color:#666">=</span> mid;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">return</span> l;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><strong>Generate Random Number</strong>: <code>rand() % wc.back() + 1</code> produces a random number between <code>1</code> and the sum of all weights (<code>wc.back()</code>).</li>
<li><strong>Binary Search for Index</strong>: Using binary search, we find the first index in <code>wc</code> where the value is greater than or equal to <code>x</code>.
<ul>
<li>If <code>wc[mid]</code> equals <code>x</code>, <code>mid</code> is returned immediately.</li>
<li>Otherwise, the search continues, adjusting <code>l</code> or <code>r</code> to find the smallest <code>mid</code> where <code>wc[mid]</code> is greater than or equal to <code>x</code>.</li>
</ul>
</li>
</ul>
<h4 id="example">Example:</h4>
<p>Suppose <code>w = [1, 3, 2]</code>. After constructing <code>wc</code>, it becomes <code>[1, 4, 6]</code>. A random value <code>x</code> within the range <code>[1, 6]</code> will land in intervals corresponding to the weights in <code>w</code>:</p>
<ul>
<li>If <code>x</code> is in <code>[1, 1]</code>, index <code>0</code> is selected.</li>
<li>If <code>x</code> is in <code>[2, 4]</code>, index <code>1</code> is selected.</li>
<li>If <code>x</code> is in <code>[5, 6]</code>, index <code>2</code> is selected.</li>
</ul>
<h3 id="complexity">Complexity</h3>
<ul>
<li><strong>Time Complexity</strong>:
<ul>
<li><strong>Constructor</strong>: Building the prefix sum array has a time complexity of <code>O(n)</code>, where <code>n</code> is the size of <code>w</code>.</li>
<li><strong>pickIndex</strong>: Each call to <code>pickIndex</code> involves a binary search, which has a time complexity of <code>O(log n)</code>.</li>
</ul>
</li>
<li><strong>Space Complexity</strong>:
<ul>
<li><strong>Constructor</strong>: The constructor requires <code>O(n)</code> space to store the prefix sum array <code>wc</code>.</li>
</ul>
</li>
</ul>
<h3 id="conclusion">Conclusion</h3>
<p>This approach is efficient and effective for solving the weighted random index selection problem:</p>
<ul>
<li>The prefix sum array allows proportional selection by creating probability intervals.</li>
<li>Binary search provides a fast way to locate the correct index based on a random value, ensuring that each index is selected in proportion to its weight.</li>
</ul>
<p>This solution is optimal in both time and space for handling random weighted selections efficiently.</p>
<p><a href="https://leetcode.com/problems/random-pick-with-weight/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/oYjDXfo-mt0?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

			</div>
		</div>
        <div class="col-md-1"></div>
	</div>
</div>

</div>


            </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
