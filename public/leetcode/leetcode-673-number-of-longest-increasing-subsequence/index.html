<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 673: Number of Longest Increasing Subsequence | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 673: Number of Longest Increasing Subsequence">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 673: Number of Longest Increasing Subsequence in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/leetcode-673-number-of-longest-increasing-subsequence/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 673: Number of Longest Increasing Subsequence">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 673: Number of Longest Increasing Subsequence in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-08-31T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Array">
    <meta property="article:tag" content="Dynamic Programming">
    <meta property="article:tag" content="Binary Indexed Tree">
    <meta property="article:tag" content="Segment Tree">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.ced6b291f6520a092efe4c87ca4fc7047e1c3174b10653f78e13ca06f0bb6abf.css" integrity="sha256-ztaykfZSCgku/kyHyk/HBH4cMXSxBlP3jhPKBvC7ar8=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
	<link rel="stylesheet" href="/css/head.css" integrity="" crossorigin="anonymous" media="screen">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="main-content">

<div class="container">
	<div class="row">
        <div class="col-md-1"></div>
		<div class="col-md-10">
			<div class="mainheading">
				<h1 class="posttitle">Leetcode 673: Number of Longest Increasing Subsequence</h1> 
            </div>
			<div class="article-post">
				<h2 id="hahahugoshortcode1248s0hbhb"><figure class="remote-image" style="text-align:center; margin: 0;">
    <div style="position: relative; width:900px; max-width:100%; padding-bottom:56.25%; overflow: hidden; border-radius:0px;">
      <img src="https://raw.githubusercontent.com/grid47/list-images/refs/heads/main/list/673.webp" 
           alt="A sequence of numbers where the longest increasing subsequence is highlighted and softly glowing." 
           style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;">
    </div>
    
      <figcaption style="font-size: 0.8em; font-weight: 300; color:#555; margin-top: 4px; line-height: 1.2;">
        Solution to LeetCode 673: Number of Longest Increasing Subsequence Problem
      </figcaption>
    
  </figure>
  </h2>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode1248s1hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">Solution</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> findNumberOfLIS(vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&amp;</span> nums) {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> res <span style="color:#666">=</span> <span style="color:#666">0</span>, n <span style="color:#666">=</span> nums.size(), max_len <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>        vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> len(n, <span style="color:#666">0</span>), cnt(n, <span style="color:#666">0</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> n; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            cnt[i] <span style="color:#666">=</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>            len[i] <span style="color:#666">=</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> j <span style="color:#666">=</span> <span style="color:#666">0</span>; j <span style="color:#666">&lt;</span> i; j<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#a2f;font-weight:bold">if</span>(nums[j] <span style="color:#666">&lt;</span> nums[i]) {
</span></span><span style="display:flex;"><span>                    <span style="color:#a2f;font-weight:bold">if</span>(len[j] <span style="color:#666">+</span> <span style="color:#666">1</span> <span style="color:#666">==</span> len[i]) cnt[i] <span style="color:#666">+=</span> cnt[j];
</span></span><span style="display:flex;"><span>                    <span style="color:#a2f;font-weight:bold">if</span>(len[j] <span style="color:#666">+</span> <span style="color:#666">1</span> <span style="color:#666">&gt;</span>  len[i]) {
</span></span><span style="display:flex;"><span>                        len[i] <span style="color:#666">=</span> len[j] <span style="color:#666">+</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>                        cnt[i] <span style="color:#666">=</span> cnt[j];
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }   
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(max_len <span style="color:#666">==</span> len[i]) res <span style="color:#666">+=</span> cnt[i];
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(max_len <span style="color:#666">&lt;</span> len[i]) {
</span></span><span style="display:flex;"><span>                res <span style="color:#666">=</span> cnt[i];
</span></span><span style="display:flex;"><span>                max_len <span style="color:#666">=</span> len[i];
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> res;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};</span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement:</h3>
<p>Given an unsorted array of integers <code>nums</code>, the goal is to find the number of longest increasing subsequences (LIS). A subsequence is a sequence that can be derived from the array by deleting some or no elements without changing the order of the remaining elements. The longest increasing subsequence is the subsequence that has the maximum length, and we need to return how many such subsequences exist.</p>
<h3 id="approach">Approach:</h3>
<p>The problem is about finding the number of distinct longest increasing subsequences (LIS) in an array. The key observations are:</p>
<ol>
<li><strong>LIS Length</strong>: A subsequence is considered increasing if each element is greater than the previous one.</li>
<li><strong>Multiple LIS</strong>: The same LIS may appear in multiple distinct ways. For example, the array <code>[1, 2, 3]</code> has one LIS, but the array <code>[1, 2, 3, 2]</code> has two LIS: <code>[1, 2, 3]</code> and <code>[1, 2, 3]</code> again.</li>
</ol>
<p>We can solve this problem using dynamic programming to find the length of the LIS and also track the count of different LIS of that length at each index.</p>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step):</h3>
<p>The algorithm uses dynamic programming (DP) with two arrays:</p>
<ol>
<li><strong>len[i]</strong>: This array stores the length of the longest increasing subsequence that ends at index <code>i</code>.</li>
<li><strong>cnt[i]</strong>: This array stores the number of distinct longest increasing subsequences that end at index <code>i</code>.</li>
</ol>
<p>We then calculate these values iteratively, ensuring that we properly track the longest subsequence and its frequency.</p>
<h4 id="step-1-initialize-the-variables">Step 1: Initialize the variables</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> res <span style="color:#666">=</span> <span style="color:#666">0</span>, n <span style="color:#666">=</span> nums.size(), max_len <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> len(n, <span style="color:#666">0</span>), cnt(n, <span style="color:#666">0</span>);
</span></span></code></pre></div><ul>
<li><code>res</code>: Stores the total count of LIS.</li>
<li><code>n</code>: The length of the input array <code>nums</code>.</li>
<li><code>max_len</code>: Tracks the maximum length of the increasing subsequences.</li>
<li><code>len</code>: A vector initialized to <code>0</code>, representing the LIS length at each index.</li>
<li><code>cnt</code>: A vector initialized to <code>0</code>, representing the count of LIS of the length <code>len[i]</code> at each index.</li>
</ul>
<h4 id="step-2-iterating-through-the-array">Step 2: Iterating through the array</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> n; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>    cnt[i] <span style="color:#666">=</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>    len[i] <span style="color:#666">=</span> <span style="color:#666">1</span>;
</span></span></code></pre></div><p>For each element <code>i</code> in the array, we initialize <code>len[i] = 1</code> (the minimum length of LIS ending at <code>i</code> is 1, the element itself) and <code>cnt[i] = 1</code> (initially, there&rsquo;s only one subsequence of length 1, the element itself).</p>
<h4 id="step-3-finding-subsequences-ending-at-index-i">Step 3: Finding subsequences ending at index <code>i</code></h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> j <span style="color:#666">=</span> <span style="color:#666">0</span>; j <span style="color:#666">&lt;</span> i; j<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">if</span>(nums[j] <span style="color:#666">&lt;</span> nums[i]) {
</span></span></code></pre></div><p>For each <code>i</code>, we check all previous elements <code>j</code> (from <code>0</code> to <code>i-1</code>). If <code>nums[j] &lt; nums[i]</code>, it means <code>nums[i]</code> can extend an increasing subsequence that ends at <code>j</code>.</p>
<h4 id="step-4-updating-leni-and-cnti">Step 4: Updating <code>len[i]</code> and <code>cnt[i]</code></h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">if</span>(len[j] <span style="color:#666">+</span> <span style="color:#666">1</span> <span style="color:#666">==</span> len[i]) cnt[i] <span style="color:#666">+=</span> cnt[j];
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">if</span>(len[j] <span style="color:#666">+</span> <span style="color:#666">1</span> <span style="color:#666">&gt;</span>  len[i]) {
</span></span><span style="display:flex;"><span>        len[i] <span style="color:#666">=</span> len[j] <span style="color:#666">+</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>        cnt[i] <span style="color:#666">=</span> cnt[j];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>If <code>len[j] + 1 == len[i]</code>, it means <code>nums[i]</code> is part of a subsequence of the same length as <code>len[i]</code>, so we add the number of subsequences ending at <code>j</code> to <code>cnt[i]</code>.</li>
<li>If <code>len[j] + 1 &gt; len[i]</code>, it means we&rsquo;ve found a longer subsequence ending at <code>i</code>, so we update <code>len[i]</code> to <code>len[j] + 1</code> and reset <code>cnt[i]</code> to <code>cnt[j]</code>, meaning that the count of LIS ending at <code>i</code> is now equal to the count of LIS ending at <code>j</code>.</li>
</ul>
<h4 id="step-5-tracking-the-maximum-length-and-the-total-count">Step 5: Tracking the maximum length and the total count</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">if</span>(max_len <span style="color:#666">==</span> len[i]) res <span style="color:#666">+=</span> cnt[i];
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">if</span>(max_len <span style="color:#666">&lt;</span> len[i]) {
</span></span><span style="display:flex;"><span>    res <span style="color:#666">=</span> cnt[i];
</span></span><span style="display:flex;"><span>    max_len <span style="color:#666">=</span> len[i];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>If <code>len[i] == max_len</code>, it means we&rsquo;ve found another subsequence of the maximum length, so we add the count of such subsequences (<code>cnt[i]</code>) to the result <code>res</code>.</li>
<li>If <code>len[i] &gt; max_len</code>, we update <code>max_len</code> to <code>len[i]</code> and set <code>res</code> to <code>cnt[i]</code> because we&rsquo;ve found a new longest subsequence, and the count of these subsequences is <code>cnt[i]</code>.</li>
</ul>
<h4 id="step-6-return-the-final-result">Step 6: Return the final result</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">return</span> res;
</span></span></code></pre></div><p>The function finally returns <code>res</code>, which contains the total count of longest increasing subsequences.</p>
<h3 id="complexity">Complexity:</h3>
<h4 id="time-complexity">Time Complexity:</h4>
<ul>
<li><strong>O(n^2)</strong>: The algorithm iterates through each element <code>i</code> and compares it with every previous element <code>j</code> to find the LIS and count the subsequences. This results in a nested loop, making the time complexity <code>O(n^2)</code>, where <code>n</code> is the length of the array <code>nums</code>.</li>
</ul>
<h4 id="space-complexity">Space Complexity:</h4>
<ul>
<li><strong>O(n)</strong>: The space complexity is dominated by the two arrays <code>len</code> and <code>cnt</code>, which each require <code>O(n)</code> space. Thus, the overall space complexity is <code>O(n)</code>.</li>
</ul>
<h3 id="conclusion">Conclusion:</h3>
<p>This approach uses dynamic programming to efficiently compute the number of distinct longest increasing subsequences (LIS). By maintaining two arrays, <code>len</code> and <code>cnt</code>, we can track the length of the LIS and the number of ways to form such subsequences ending at each index. The algorithm performs well for arrays of moderate size with a time complexity of <code>O(n^2)</code>.</p>
<p>Key observations include:</p>
<ul>
<li>Each element is processed in relation to every previous element to build the longest subsequence ending at that element.</li>
<li>The algorithm efficiently counts how many distinct LIS can end at each position in the array and tracks the global maximum length.</li>
</ul>
<p>This solution works effectively for finding the number of LIS in an array and can handle typical input sizes in competitive programming and real-world applications.</p>
<p><a href="https://leetcode.com/problems/number-of-longest-increasing-subsequence/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/Tuc-rjJbsXU?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

			</div>
		</div>
        <div class="col-md-1"></div>
	</div>
</div>

</div>


            </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
