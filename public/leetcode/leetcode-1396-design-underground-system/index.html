<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 1396: Design Underground System | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 1396: Design Underground System">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 1396: Design Underground System in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/leetcode-1396-design-underground-system/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 1396: Design Underground System">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 1396: Design Underground System in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-06-20T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Hash Table">
    <meta property="article:tag" content="String">
    <meta property="article:tag" content="Design">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.ced6b291f6520a092efe4c87ca4fc7047e1c3174b10653f78e13ca06f0bb6abf.css" integrity="sha256-ztaykfZSCgku/kyHyk/HBH4cMXSxBlP3jhPKBvC7ar8=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
	<link rel="stylesheet" href="/css/head.css" integrity="" crossorigin="anonymous" media="screen">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="main-content">

<div class="container">
	<div class="row">
        <div class="col-md-1"></div>
		<div class="col-md-10">
			<div class="mainheading">
				<h1 class="posttitle">Leetcode 1396: Design Underground System</h1> 
            </div>
			<div class="article-post">
				<hr>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode195s0hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">struct</span> <span style="color:#00f">Node</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> time;
</span></span><span style="display:flex;"><span>    string station;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">UndergroundSystem</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    map<span style="color:#666">&lt;</span>string, map<span style="color:#666">&lt;</span>string, <span style="color:#0b0;font-weight:bold">double</span><span style="color:#666">&gt;&gt;</span> cnt, sum;
</span></span><span style="display:flex;"><span>    map<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, Node<span style="color:#666">&gt;</span> user;
</span></span><span style="display:flex;"><span>    UndergroundSystem() {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">checkIn</span>(<span style="color:#0b0;font-weight:bold">int</span> id, string name, <span style="color:#0b0;font-weight:bold">int</span> t) {
</span></span><span style="display:flex;"><span>        Node n;
</span></span><span style="display:flex;"><span>        n.time <span style="color:#666">=</span> t;
</span></span><span style="display:flex;"><span>        n.station <span style="color:#666">=</span> name;
</span></span><span style="display:flex;"><span>        user[id] <span style="color:#666">=</span> n;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">checkOut</span>(<span style="color:#0b0;font-weight:bold">int</span> id, string name, <span style="color:#0b0;font-weight:bold">int</span> t) {
</span></span><span style="display:flex;"><span>        Node entry <span style="color:#666">=</span> user[id];
</span></span><span style="display:flex;"><span>        cout <span style="color:#666">&lt;&lt;</span> user[id].station;
</span></span><span style="display:flex;"><span>        user.erase(id);
</span></span><span style="display:flex;"><span>        cnt[entry.station][name]<span style="color:#666">++</span>;
</span></span><span style="display:flex;"><span>        sum[entry.station][name]<span style="color:#666">+=</span> t <span style="color:#666">-</span> entry.time;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">double</span> <span style="color:#00a000">getAverageTime</span>(string start, string end) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> sum[start][end] <span style="color:#666">/</span> cnt[start][end];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * Your UndergroundSystem object will be instantiated and called as such:
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * UndergroundSystem* obj = new UndergroundSystem();
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * obj-&gt;checkIn(id,stationName,t);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * obj-&gt;checkOut(id,stationName,t);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * double param_3 = obj-&gt;getAverageTime(startStation,endStation);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> */</span></span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement</h3>
<p>The problem is to implement a system that tracks the check-in and check-out times of passengers at various stations in an underground transportation system. The goal is to allow passengers to check in and out at different stations while being able to retrieve the average travel time between any two stations. This system involves managing user data effectively and calculating average travel times based on the recorded check-in and check-out times.</p>
<h3 id="approach">Approach</h3>
<p>To address this problem, we utilize a class-based design in C++, leveraging several data structures to efficiently store and manage passenger data and travel times. The following are the key components of our approach:</p>
<ol>
<li>
<p><strong>Data Structures</strong>:</p>
<ul>
<li><strong>Maps</strong>: We use two maps:
<ul>
<li><code>cnt</code>: A nested map that tracks the count of trips between stations. The outer map uses the starting station as the key, while the inner map uses the destination station as the key to store the number of trips taken between the two stations.</li>
<li><code>sum</code>: Another nested map that keeps the total travel time for each trip between stations. This allows us to compute the average travel time efficiently.</li>
</ul>
</li>
<li><strong>Node Struct</strong>: A simple struct <code>Node</code> is defined to store the check-in time and station name for each passenger, enabling easy retrieval of check-in information when the passenger checks out.</li>
</ul>
</li>
<li>
<p><strong>Check-In and Check-Out Logic</strong>:</p>
<ul>
<li><strong>Check-In</strong>: When a passenger checks in, we record their ID, station, and time in a map (<code>user</code>). The passenger&rsquo;s information is stored in a <code>Node</code> instance associated with their ID.</li>
<li><strong>Check-Out</strong>: Upon checking out, we retrieve the passenger&rsquo;s check-in information, calculate the travel time, update the <code>cnt</code> and <code>sum</code> maps accordingly, and remove the passenger&rsquo;s data from the <code>user</code> map.</li>
</ul>
</li>
<li>
<p><strong>Average Travel Time Calculation</strong>:</p>
<ul>
<li>The <code>getAverageTime</code> function computes the average travel time between two stations by dividing the total travel time by the count of trips. This provides an efficient way to return results for any queried route.</li>
</ul>
</li>
</ol>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step)</h3>
<p>Here’s a detailed step-by-step breakdown of the provided C++ code:</p>
<ol>
<li>
<p><strong>Node Struct Definition</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">struct</span> <span style="color:#00f">Node</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> time;
</span></span><span style="display:flex;"><span>    string station;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ul>
<li>A <code>Node</code> structure is defined to hold the check-in time and station name.</li>
</ul>
</li>
<li>
<p><strong>Class Definition</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">UndergroundSystem</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    map<span style="color:#666">&lt;</span>string, map<span style="color:#666">&lt;</span>string, <span style="color:#0b0;font-weight:bold">double</span><span style="color:#666">&gt;&gt;</span> cnt, sum;
</span></span><span style="display:flex;"><span>    map<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, Node<span style="color:#666">&gt;</span> user;
</span></span></code></pre></div><ul>
<li>The <code>UndergroundSystem</code> class is defined. It contains:
<ul>
<li><code>cnt</code>: A map for counting trips between stations.</li>
<li><code>sum</code>: A map for summing travel times between stations.</li>
<li><code>user</code>: A map that holds the check-in information for each passenger based on their ID.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Constructor</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    UndergroundSystem() {
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><ul>
<li>A default constructor initializes the class instance. No additional setup is required at this point.</li>
</ul>
</li>
<li>
<p><strong>Check-In Method</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">checkIn</span>(<span style="color:#0b0;font-weight:bold">int</span> id, string name, <span style="color:#0b0;font-weight:bold">int</span> t) {
</span></span><span style="display:flex;"><span>        Node n;
</span></span><span style="display:flex;"><span>        n.time <span style="color:#666">=</span> t;
</span></span><span style="display:flex;"><span>        n.station <span style="color:#666">=</span> name;
</span></span><span style="display:flex;"><span>        user[id] <span style="color:#666">=</span> n;
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><ul>
<li>The <code>checkIn</code> method takes the passenger&rsquo;s ID, station name, and time as parameters.</li>
<li>A <code>Node</code> is created to store the current station and time.</li>
<li>This node is then stored in the <code>user</code> map using the passenger ID as the key.</li>
</ul>
</li>
<li>
<p><strong>Check-Out Method</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">checkOut</span>(<span style="color:#0b0;font-weight:bold">int</span> id, string name, <span style="color:#0b0;font-weight:bold">int</span> t) {
</span></span><span style="display:flex;"><span>        Node entry <span style="color:#666">=</span> user[id];
</span></span><span style="display:flex;"><span>        cout <span style="color:#666">&lt;&lt;</span> user[id].station; <span style="color:#080;font-style:italic">// Debug line (can be removed)
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>        user.erase(id);
</span></span><span style="display:flex;"><span>        cnt[entry.station][name]<span style="color:#666">++</span>;
</span></span><span style="display:flex;"><span>        sum[entry.station][name]<span style="color:#666">+=</span> t <span style="color:#666">-</span> entry.time;
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><ul>
<li>The <code>checkOut</code> method retrieves the passenger’s check-in information using their ID.</li>
<li>It calculates the travel time by subtracting the check-in time from the current time.</li>
<li>The counts and sums for trips between the checked-in and checked-out stations are updated.</li>
<li>The passenger’s information is removed from the <code>user</code> map.</li>
</ul>
</li>
<li>
<p><strong>Average Time Calculation Method</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">double</span> <span style="color:#00a000">getAverageTime</span>(string start, string end) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> sum[start][end] <span style="color:#666">/</span> cnt[start][end];
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><ul>
<li>The <code>getAverageTime</code> method takes the starting and ending station names as parameters.</li>
<li>It calculates the average time by dividing the total travel time (stored in <code>sum</code>) by the count of trips (stored in <code>cnt</code>).</li>
<li>The average travel time is returned as a double.</li>
</ul>
</li>
<li>
<p><strong>Usage</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#080;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * Your UndergroundSystem object will be instantiated and called as such:
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * UndergroundSystem* obj = new UndergroundSystem();
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * obj-&gt;checkIn(id,stationName,t);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * obj-&gt;checkOut(id,stationName,t);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * double param_3 = obj-&gt;getAverageTime(startStation,endStation);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> */</span>
</span></span></code></pre></div><ul>
<li>This section outlines how to create an instance of <code>UndergroundSystem</code> and how to use the provided methods.</li>
</ul>
</li>
</ol>
<h3 id="complexity">Complexity</h3>
<ul>
<li>
<p><strong>Time Complexity</strong>:</p>
<ul>
<li><strong>Check-In and Check-Out</strong>: Both operations run in ( O(1) ) time on average due to direct access to hash maps.</li>
<li><strong>Get Average Time</strong>: This operation also runs in ( O(1) ) since it involves direct access to the maps for the sum and count.</li>
</ul>
</li>
<li>
<p><strong>Space Complexity</strong>:</p>
<ul>
<li>The space complexity is ( O(n) ), where ( n ) is the number of unique passengers checked in and the number of routes taken between stations. This is due to the storage requirements for the maps.</li>
</ul>
</li>
</ul>
<h3 id="conclusion">Conclusion</h3>
<p>This implementation of the underground system efficiently manages passenger check-ins and check-outs while providing quick access to average travel times between stations.</p>
<p>Key takeaways from this solution include:</p>
<ul>
<li><strong>Efficient Data Management</strong>: Using maps to store counts and sums allows for efficient aggregation of travel times.</li>
<li><strong>Clear Separation of Responsibilities</strong>: The code cleanly separates the logic for check-in, check-out, and average time calculation, improving readability and maintainability.</li>
<li><strong>Utilization of Structs</strong>: The <code>Node</code> struct provides a clean way to encapsulate the check-in information for passengers, making the code easier to understand.</li>
</ul>
<p>Overall, this design demonstrates effective use of data structures and algorithms to solve a real-world problem, making it suitable for applications in transportation systems and other domains requiring similar functionalities.</p>
<p><a href="https://leetcode.com/problems/design-underground-system/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/W5QOLqXskZM?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

			</div>
		</div>
        <div class="col-md-1"></div>
	</div>
</div>

</div>


            </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
