<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 901: Online Stock Span | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 901: Online Stock Span">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 901: Online Stock Span in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/leetcode-901-online-stock-span/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 901: Online Stock Span">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 901: Online Stock Span in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-08-08T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Stack">
    <meta property="article:tag" content="Design">
    <meta property="article:tag" content="Monotonic Stack">
    <meta property="article:tag" content="Data Stream">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.ced6b291f6520a092efe4c87ca4fc7047e1c3174b10653f78e13ca06f0bb6abf.css" integrity="sha256-ztaykfZSCgku/kyHyk/HBH4cMXSxBlP3jhPKBvC7ar8=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
	<link rel="stylesheet" href="/css/head.css" integrity="" crossorigin="anonymous" media="screen">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="main-content">

<div class="container">
	<div class="row">
        <div class="col-md-1"></div>
		<div class="col-md-10">
			<div class="mainheading">
				<h1 class="posttitle">Leetcode 901: Online Stock Span</h1> 
            </div>
			<div class="article-post">
				<hr>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode1382s0hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">StockSpanner</span> {
</span></span><span style="display:flex;"><span>    stack<span style="color:#666">&lt;</span>pair<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, <span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;</span> cp;
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    StockSpanner() {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">next</span>(<span style="color:#0b0;font-weight:bold">int</span> price) {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> res <span style="color:#666">=</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">while</span>(<span style="color:#666">!</span>cp.empty() <span style="color:#666">&amp;&amp;</span> cp.top().first <span style="color:#666">&lt;=</span> price) {
</span></span><span style="display:flex;"><span>            res <span style="color:#666">+=</span> cp.top().second;
</span></span><span style="display:flex;"><span>            cp.pop();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        cp.push(make_pair(price, res));
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> res;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * Your StockSpanner object will be instantiated and called as such:
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * StockSpanner* obj = new StockSpanner();
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * int param_1 = obj-&gt;next(price);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> */</span></span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement</h3>
<p>The problem asks us to design a <strong>StockSpanner</strong> class that supports the following method:</p>
<ul>
<li><code>next(price)</code> â€” this method will receive an integer <code>price</code> representing the current day&rsquo;s stock price. It should return an integer that represents the <strong>span</strong> of the stock&rsquo;s price, defined as the number of consecutive days (including today) where the stock price was less than or equal to <code>price</code>.</li>
</ul>
<p>The <strong>span</strong> of a stock is the number of consecutive days up to the current day where the stock price was greater than or equal to today&rsquo;s price. For example, if the stock prices for the last 5 days are <code>[100, 80, 60, 70, 60]</code>, and today&rsquo;s price is 75, then the stock span for the day with price 75 would be 2, since the price was greater than or equal to 75 on the two previous days.</p>
<p>We are to implement the class <code>StockSpanner</code> that efficiently calculates the span for each price on each call to <code>next(price)</code>.</p>
<h3 id="approach">Approach</h3>
<p>To solve this problem efficiently, we can use a <strong>monotonic stack</strong> to track the indices of the stock prices in a way that allows us to efficiently calculate the span for each price.</p>
<h4 id="explanation-of-approach"><strong>Explanation of Approach</strong></h4>
<ol>
<li>
<p><strong>Monotonic Stack</strong>:</p>
<ul>
<li>We use a stack to store pairs of stock prices and their corresponding spans. Each pair contains:
<ul>
<li>The stock price on a particular day.</li>
<li>The span of that stock price, which is how many consecutive days (including the current day) the stock price has been greater than or equal to the price on that day.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Pop from Stack</strong>:</p>
<ul>
<li>For each new price, we compare it with the price at the top of the stack. If the price at the top of the stack is less than or equal to the new price, we pop that price from the stack and add its span to the span of the new price.</li>
<li>This is because the span of the current price will include the span of the prices that are less than or equal to it (as we can include all consecutive days where the price was less than or equal to the current price).</li>
</ul>
</li>
<li>
<p><strong>Update Span</strong>:</p>
<ul>
<li>If we pop items from the stack, we continue adding their spans to the current span until we find a price greater than the current price or the stack becomes empty.</li>
<li>Once the stack is empty or we find a price greater than the current price, the span for the current price is calculated and pushed onto the stack.</li>
</ul>
</li>
<li>
<p><strong>Efficiency</strong>:</p>
<ul>
<li>Each price is pushed and popped from the stack at most once, making the time complexity of each <code>next(price)</code> call <strong>O(1)</strong>, leading to an overall <strong>O(n)</strong> time complexity for a sequence of <code>n</code> price inputs.</li>
</ul>
</li>
</ol>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step)</h3>
<h4 id="class-definition"><strong>Class Definition</strong></h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">StockSpanner</span> {
</span></span><span style="display:flex;"><span>    stack<span style="color:#666">&lt;</span>pair<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, <span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;</span> cp;
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    StockSpanner() {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">next</span>(<span style="color:#0b0;font-weight:bold">int</span> price) {
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> res <span style="color:#666">=</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">while</span>(<span style="color:#666">!</span>cp.empty() <span style="color:#666">&amp;&amp;</span> cp.top().first <span style="color:#666">&lt;=</span> price) {
</span></span><span style="display:flex;"><span>            res <span style="color:#666">+=</span> cp.top().second;
</span></span><span style="display:flex;"><span>            cp.pop();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        cp.push(make_pair(price, res));
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> res;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ol>
<li>
<p><strong>StockSpanner Class</strong>:</p>
<ul>
<li>We define the class <code>StockSpanner</code> with a private member <code>cp</code>, which is a stack of pairs.
<ul>
<li>The stack stores pairs of <code>(price, span)</code>, where <code>price</code> is the stock price on a given day, and <code>span</code> is the stock span for that price.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Constructor</strong>:</p>
<ul>
<li>The constructor initializes the stack <code>cp</code> to be empty. It does not need to take any parameters since we initialize the stack when a new <code>StockSpanner</code> object is created.</li>
</ul>
</li>
<li>
<p><strong><code>next(price)</code> Method</strong>:</p>
<ul>
<li>
<p><strong>Initialize Span</strong>: We initialize <code>res</code> to 1 because the span of the current day&rsquo;s price is at least 1 (the price itself).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> res <span style="color:#666">=</span> <span style="color:#666">1</span>;
</span></span></code></pre></div></li>
<li>
<p><strong>Pop Prices from the Stack</strong>:</p>
<ul>
<li>We enter a loop where we check if the stack is non-empty and the price at the top of the stack is less than or equal to the current price (<code>cp.top().first &lt;= price</code>).</li>
<li>If this condition is true, we add the span of the top element (<code>cp.top().second</code>) to the result (<code>res</code>) and pop the top element off the stack.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">while</span>(<span style="color:#666">!</span>cp.empty() <span style="color:#666">&amp;&amp;</span> cp.top().first <span style="color:#666">&lt;=</span> price) {
</span></span><span style="display:flex;"><span>    res <span style="color:#666">+=</span> cp.top().second;
</span></span><span style="display:flex;"><span>    cp.pop();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p><strong>Push Current Price and Span onto the Stack</strong>:</p>
<ul>
<li>After processing any prices from the stack, we push the current price and its span onto the stack.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>cp.push(make_pair(price, res));
</span></span></code></pre></div></li>
<li>
<p><strong>Return the Span</strong>:</p>
<ul>
<li>Finally, we return the span for the current price, which is stored in <code>res</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">return</span> res;
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Example Usage</strong>:</p>
<ul>
<li>An instance of the <code>StockSpanner</code> class is created, and we repeatedly call <code>next(price)</code> to get the span for each stock price.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>StockSpanner<span style="color:#666">*</span> obj <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> StockSpanner();
</span></span><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> param_1 <span style="color:#666">=</span> obj<span style="color:#666">-&gt;</span>next(price);
</span></span></code></pre></div></li>
</ol>
<h3 id="complexity">Complexity</h3>
<h4 id="time-complexity"><strong>Time Complexity</strong></h4>
<ul>
<li>Each price is pushed onto the stack and popped from the stack at most once. As a result, the time complexity for each <code>next(price)</code> call is <strong>O(1)</strong>, and for a sequence of <code>n</code> price inputs, the overall time complexity is <strong>O(n)</strong>.</li>
</ul>
<h4 id="space-complexity"><strong>Space Complexity</strong></h4>
<ul>
<li>The space complexity of the solution is <strong>O(n)</strong>, where <code>n</code> is the number of stock prices in the sequence. This is because, in the worst case, all prices could be stored in the stack, each having a corresponding span.</li>
</ul>
<h3 id="conclusion">Conclusion</h3>
<p>The <code>StockSpanner</code> class provides an efficient solution for calculating the span of stock prices using a <strong>monotonic stack</strong>. By leveraging the stack to store pairs of stock prices and their corresponding spans, we can efficiently compute the span for each price with each <code>next(price)</code> call in constant time, resulting in an overall time complexity of <strong>O(n)</strong> for <code>n</code> price inputs.</p>
<p>The solution is both space-efficient and time-efficient, handling even large sequences of stock prices efficiently. The stack-based approach ensures that we only need to process each stock price once, making it an optimal solution for this problem.</p>
<p><a href="https://leetcode.com/problems/online-stock-span/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/slYh0ZNEqSw?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

			</div>
		</div>
        <div class="col-md-1"></div>
	</div>
</div>

</div>


            </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
