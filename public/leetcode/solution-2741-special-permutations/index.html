<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 2741: Special Permutations | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 2741: Special Permutations">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 2741: Special Permutations in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/solution-2741-special-permutations/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 2741: Special Permutations">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 2741: Special Permutations in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-02-06T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Array">
    <meta property="article:tag" content="Dynamic Programming">
    <meta property="article:tag" content="Bit Manipulation">
    <meta property="article:tag" content="Bitmask">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.a3d5489836b19de22a81ddc6bd21c17547d07529e67b266427378a04fa3ea727.css" integrity="sha256-o9VImDaxneIqgd3GvSHBdUfQdSnmeyZkJzeKBPo&#43;pyc=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="mainheading">
    <h1 class="sitetitle">grid47</h1>
    <p class="lead">
         Blog by grid47
    </p>
</div><div class="main-content">
        
        <div class="container">
            <div class="row">
                
                <div class="col-md-2 pl-0"><div class="share sticky-top sticky-top-offset">
    <p>Share</p>
    <ul>
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://twitter.com/intent/tweet?text=Leetcode%202741%3a%20Special%20Permutations&url=http%3a%2f%2flocalhost%3a1313%2fleetcode%2fsolution-2741-special-permutations%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=435');return false;">
        <i class="fab fa-twitter"></i>
        </a>
        </li>
        
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://facebook.com/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fleetcode%2fsolution-2741-special-permutations%2f" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
        <i class="fab fa-facebook-f"></i>
        </a>
        </li>

        <li class="ml-1 mr-1">
        <a target="_blank" href="https://www.xing.com/spi/shares/new?url=http%3a%2f%2flocalhost%3a1313%2fleetcode%2fsolution-2741-special-permutations%2f" onclick="window.open(this.href, 'xing-share', 'width=550,height=435');return false;">
        <i class="fab fa-xing"></i>
        </a>
        </li>        
    </ul>

    
</div>
</div>
                                
                <div class="col-md-9 flex-first flex-md-unordered">
                    <div class="mainheading">
                        	
                        
                        
                        
                        <div class="row post-top-meta">
                            <div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0 md-nopad-right">
                                <img class="author-thumb" src="/images/logo.png" alt="grid47">
                            </div>
                            <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left md-nopad-left">
                                <a target="_blank" class="link-dark">grid47</a><br>
                                <span class="author-description">
                                    Exploring patterns and algorithms<br>
                                    <i class="far fa-star"></i>
                                    Feb 6, 2024
                                    <i class="far fa-clock clock"></i>
                                    6 min read
                                </span>					
                            </div>
                        </div>			
                        	
                        
                                                
                        
                        <h1 class="posttitle">Leetcode 2741: Special Permutations</h1> 
                    </div>

                    
                    
                    
                    

                    
                    <div class="article-post">
                        <hr>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode2449s0hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">Solution</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> mod <span style="color:#666">=</span> (<span style="color:#0b0;font-weight:bold">int</span>) <span style="color:#666">1e9</span> <span style="color:#666">+</span> <span style="color:#666">7</span>;
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;</span> grid;
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span>map<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, <span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;</span> mp;
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">specialPerm</span>(vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&amp;</span> nums) {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> conn <span style="color:#666">=</span> <span style="color:#666">0</span>, n <span style="color:#666">=</span> nums.size();
</span></span><span style="display:flex;"><span>        grid.resize(n);
</span></span><span style="display:flex;"><span>        mp.resize(n);
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> n; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> j <span style="color:#666">=</span> i <span style="color:#666">+</span> <span style="color:#666">1</span>; j <span style="color:#666">&lt;</span> n; j<span style="color:#666">++</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#a2f;font-weight:bold">if</span>(nums[i] <span style="color:#666">%</span> nums[j] <span style="color:#666">==</span> <span style="color:#666">0</span> <span style="color:#666">||</span> nums[j] <span style="color:#666">%</span> nums[i] <span style="color:#666">==</span> <span style="color:#666">0</span>){
</span></span><span style="display:flex;"><span>                    grid[i].push_back(j);
</span></span><span style="display:flex;"><span>                    grid[j].push_back(i);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">long</span> ans <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> n; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#0b0;font-weight:bold">int</span> msk <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>            msk <span style="color:#666">|=</span> (<span style="color:#666">1</span> <span style="color:#666">&lt;&lt;</span> i);
</span></span><span style="display:flex;"><span>            ans <span style="color:#666">=</span> (ans <span style="color:#666">+</span> dfs(i, n <span style="color:#666">-</span> <span style="color:#666">1</span>, msk)) <span style="color:#666">%</span> mod;            
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> ans;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">dfs</span>(<span style="color:#0b0;font-weight:bold">int</span> i, <span style="color:#0b0;font-weight:bold">int</span> n, <span style="color:#0b0;font-weight:bold">int</span> msk) {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span>(n <span style="color:#666">==</span> <span style="color:#666">0</span>) <span style="color:#a2f;font-weight:bold">return</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span>(mp[i].count(msk)) <span style="color:#a2f;font-weight:bold">return</span> mp[i][msk];
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">long</span> ans <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> <span style="color:#a0a000">x</span>: grid[i]) {
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(<span style="color:#666">!</span>(msk <span style="color:#666">&amp;</span> (<span style="color:#666">1</span> <span style="color:#666">&lt;&lt;</span> x))) {
</span></span><span style="display:flex;"><span>                msk <span style="color:#666">^=</span> (<span style="color:#666">1</span> <span style="color:#666">&lt;&lt;</span> x);
</span></span><span style="display:flex;"><span>                ans <span style="color:#666">=</span> (ans <span style="color:#666">+</span> dfs(x, n <span style="color:#666">-</span> <span style="color:#666">1</span>, msk)) <span style="color:#666">%</span> mod;
</span></span><span style="display:flex;"><span>                msk <span style="color:#666">^=</span> (<span style="color:#666">1</span> <span style="color:#666">&lt;&lt;</span> x);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> mp[i][msk] <span style="color:#666">=</span> ans;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>};</span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement</h3>
<p>The problem asks to find the number of special permutations of a given list of integers, <code>nums</code>, where a permutation is considered &ldquo;special&rdquo; if, for every pair of adjacent numbers in the permutation, one number is divisible by the other. The solution must compute this count efficiently, given the constraint that the number of permutations can grow very large.</p>
<h3 id="approach">Approach</h3>
<p>This problem can be broken down into the following key steps:</p>
<ol>
<li>
<p><strong>Graph Representation</strong>:</p>
<ul>
<li>The first task is to represent the divisibility condition between numbers as a graph. Each number in the input array <code>nums</code> is treated as a node in the graph. There is an edge between two nodes if one number divides the other. This allows us to model the problem as finding valid paths in this graph, where the paths correspond to the &ldquo;special&rdquo; permutations.</li>
</ul>
</li>
<li>
<p><strong>Bitmasking and Dynamic Programming (DP)</strong>:</p>
<ul>
<li>Since we are working with permutations, a brute-force approach would require generating all possible permutations of the numbers, which would be computationally expensive for large arrays. Instead, we use dynamic programming with bitmasking to track the numbers that have already been used in the permutation. The bitmask efficiently represents the state of which elements from the array have been included in the current permutation.</li>
</ul>
</li>
<li>
<p><strong>DFS for Counting Permutations</strong>:</p>
<ul>
<li>Depth-first search (DFS) is used to explore all valid permutations of the numbers. At each step, we try to place a number in the current position, and we recursively explore the next possible positions while respecting the divisibility condition. We cache the results of subproblems using memoization to avoid redundant calculations.</li>
</ul>
</li>
<li>
<p><strong>Modulo Operation</strong>:</p>
<ul>
<li>Given that the number of valid permutations can be very large, we return the result modulo (10^9 + 7), which is a common practice in competitive programming to prevent overflow and ensure that the result fits within standard integer limits.</li>
</ul>
</li>
</ol>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step)</h3>
<p>Let&rsquo;s break down the code into smaller parts for better understanding:</p>
<h4 id="1-initialization-and-setup">1. <strong>Initialization and Setup</strong></h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> mod <span style="color:#666">=</span> (<span style="color:#0b0;font-weight:bold">int</span>) <span style="color:#666">1e9</span> <span style="color:#666">+</span> <span style="color:#666">7</span>;
</span></span><span style="display:flex;"><span>vector<span style="color:#666">&lt;</span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;</span> grid;
</span></span><span style="display:flex;"><span>vector<span style="color:#666">&lt;</span>map<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, <span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;</span> mp;
</span></span><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">specialPerm</span>(vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&amp;</span> nums) {
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> conn <span style="color:#666">=</span> <span style="color:#666">0</span>, n <span style="color:#666">=</span> nums.size();
</span></span><span style="display:flex;"><span>    grid.resize(n);
</span></span><span style="display:flex;"><span>    mp.resize(n);
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> n; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> j <span style="color:#666">=</span> i <span style="color:#666">+</span> <span style="color:#666">1</span>; j <span style="color:#666">&lt;</span> n; j<span style="color:#666">++</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(nums[i] <span style="color:#666">%</span> nums[j] <span style="color:#666">==</span> <span style="color:#666">0</span> <span style="color:#666">||</span> nums[j] <span style="color:#666">%</span> nums[i] <span style="color:#666">==</span> <span style="color:#666">0</span>){
</span></span><span style="display:flex;"><span>                grid[i].push_back(j);
</span></span><span style="display:flex;"><span>                grid[j].push_back(i);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><ul>
<li><strong>Grid Construction</strong>:
<ul>
<li>A <code>grid</code> is created to represent the graph, where each element <code>grid[i]</code> contains the list of indices <code>j</code> that are connected to <code>i</code>. Two elements are connected if one is divisible by the other.</li>
</ul>
</li>
<li><strong>Memoization Table</strong>:
<ul>
<li>A memoization table <code>mp</code> is used to store the results of subproblems. Each entry <code>mp[i][msk]</code> will store the number of valid special permutations starting from the <code>i</code>-th index, with the subset of elements represented by the bitmask <code>msk</code> already used.</li>
</ul>
</li>
<li><strong>Nested Loops for Divisibility</strong>:
<ul>
<li>Two nested loops iterate over all pairs of elements in the <code>nums</code> array, and if one element is divisible by the other (or vice versa), we add an edge between the corresponding nodes in the graph (by adding each index to the <code>grid</code> of the other index).</li>
</ul>
</li>
</ul>
<h4 id="2-main-logic-for-special-permutation-count">2. <strong>Main Logic for Special Permutation Count</strong></h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">long</span> ans <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> n; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> msk <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    msk <span style="color:#666">|=</span> (<span style="color:#666">1</span> <span style="color:#666">&lt;&lt;</span> i);
</span></span><span style="display:flex;"><span>    ans <span style="color:#666">=</span> (ans <span style="color:#666">+</span> dfs(i, n <span style="color:#666">-</span> <span style="color:#666">1</span>, msk)) <span style="color:#666">%</span> mod;            
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">return</span> ans;
</span></span></code></pre></div><ul>
<li><strong>DFS for Permutation Counting</strong>:
<ul>
<li>We initiate a DFS call for each number in the list, treating it as the first element in the permutation. The bitmask <code>msk</code> is used to mark the number as &ldquo;used,&rdquo; ensuring that no number is repeated in the permutation.</li>
<li>We sum up the results of the DFS calls for each number, using the modulo operation to avoid overflow.</li>
</ul>
</li>
</ul>
<h4 id="3-depth-first-search-dfs-with-memoization">3. <strong>Depth-First Search (DFS) with Memoization</strong></h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">dfs</span>(<span style="color:#0b0;font-weight:bold">int</span> i, <span style="color:#0b0;font-weight:bold">int</span> n, <span style="color:#0b0;font-weight:bold">int</span> msk) {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">if</span>(n <span style="color:#666">==</span> <span style="color:#666">0</span>) <span style="color:#a2f;font-weight:bold">return</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">if</span>(mp[i].count(msk)) <span style="color:#a2f;font-weight:bold">return</span> mp[i][msk];
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">long</span> ans <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> <span style="color:#a0a000">x</span>: grid[i]) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span>(<span style="color:#666">!</span>(msk <span style="color:#666">&amp;</span> (<span style="color:#666">1</span> <span style="color:#666">&lt;&lt;</span> x))) {
</span></span><span style="display:flex;"><span>            msk <span style="color:#666">^=</span> (<span style="color:#666">1</span> <span style="color:#666">&lt;&lt;</span> x);
</span></span><span style="display:flex;"><span>            ans <span style="color:#666">=</span> (ans <span style="color:#666">+</span> dfs(x, n <span style="color:#666">-</span> <span style="color:#666">1</span>, msk)) <span style="color:#666">%</span> mod;
</span></span><span style="display:flex;"><span>            msk <span style="color:#666">^=</span> (<span style="color:#666">1</span> <span style="color:#666">&lt;&lt;</span> x);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">return</span> mp[i][msk] <span style="color:#666">=</span> ans;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><strong>Base Case</strong>:
<ul>
<li>When <code>n == 0</code>, we have successfully constructed a valid permutation, so we return <code>1</code>.</li>
</ul>
</li>
<li><strong>Memoization Lookup</strong>:
<ul>
<li>Before proceeding with the DFS, we check if the result for the current state (current index <code>i</code> and bitmask <code>msk</code>) has already been computed and stored in <code>mp[i][msk]</code>. If it has, we return the stored value to avoid redundant computations.</li>
</ul>
</li>
<li><strong>DFS Exploration</strong>:
<ul>
<li>For each adjacent element <code>x</code> in <code>grid[i]</code>, we check if <code>x</code> has already been included in the permutation by checking the corresponding bit in <code>msk</code>. If not, we add <code>x</code> to the permutation by updating <code>msk</code>, recursively call DFS to explore further permutations, and then backtrack by reverting <code>msk</code>.</li>
</ul>
</li>
</ul>
<h4 id="4-result-calculation-and-modulo-operation">4. <strong>Result Calculation and Modulo Operation</strong></h4>
<ul>
<li>After all recursive calls, we store the result in <code>mp[i][msk]</code> and continue the DFS exploration. The final result is returned modulo (10^9 + 7).</li>
</ul>
<h3 id="complexity-analysis">Complexity Analysis</h3>
<h4 id="time-complexity">Time Complexity:</h4>
<ul>
<li>
<p><strong>Grid Construction</strong>:</p>
<ul>
<li>The nested loops to build the <code>grid</code> take (O(n^2)) time, where (n) is the size of the <code>nums</code> array.</li>
</ul>
</li>
<li>
<p><strong>DFS and Memoization</strong>:</p>
<ul>
<li>The DFS explores all subsets of the array (represented by the bitmask <code>msk</code>), leading to a time complexity of (O(n \cdot 2^n)), where (2^n) represents the number of possible subsets and (n) is the number of nodes (elements in the array).</li>
</ul>
</li>
</ul>
<p>Thus, the overall time complexity is (O(n^2 + n \cdot 2^n)).</p>
<h4 id="space-complexity">Space Complexity:</h4>
<ul>
<li><strong>Grid and Memoization Tables</strong>:
<ul>
<li>The <code>grid</code> takes (O(n^2)) space, and the memoization table <code>mp</code> takes (O(n \cdot 2^n)) space.</li>
</ul>
</li>
</ul>
<p>Thus, the overall space complexity is (O(n^2 + n \cdot 2^n)).</p>
<h3 id="conclusion">Conclusion</h3>
<p>This approach efficiently calculates the number of special permutations using graph theory and dynamic programming with bitmasking. By leveraging memoization and DFS, we can avoid recalculating results for overlapping subproblems, significantly reducing the computational effort compared to a brute-force approach.</p>
<ul>
<li><strong>Time Complexity</strong>: (O(n^2 + n \cdot 2^n)), where (n) is the size of the input array.</li>
<li><strong>Space Complexity</strong>: (O(n^2 + n \cdot 2^n)).</li>
</ul>
<p>This solution is optimal for the problem, utilizing efficient techniques like DFS and bitmasking to handle large input sizes effectively.</p>
<p><a href="https://leetcode.com/problems/special-permutations/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/AxXNOXj1upY?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

                    </div>
                    
                    
                    <div class="after-post-tags">
                        <ul class="tags">
                        
                        <li>
                        <a href="/tags/array">Array</a>
                        </li>
                        
                        <li>
                        <a href="/tags/dynamic-programming">Dynamic Programming</a>
                        </li>
                        
                        <li>
                        <a href="/tags/bit-manipulation">Bit Manipulation</a>
                        </li>
                        
                        <li>
                        <a href="/tags/bitmask">Bitmask</a>
                        </li>
                        
                        </ul>
                    </div>
                    
                    
                    
                    <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
                    
                        <a class="d-block col-md-6" href="http://localhost:1313/leetcode/solution-2740-find-the-value-of-the-partition/"> &laquo; Leetcode 2740: Find the Value of the Partition</a>
                    
                    
                        <a class="d-block col-md-6 text-lg-right" href="http://localhost:1313/leetcode/solution-2744-find-maximum-number-of-string-pairs/">Leetcode 2744: Find Maximum Number of String Pairs &raquo;</a>
                    
                    <div class="clearfix"></div>
                    </div>
                    
                </div>
                
            </div>
        </div>
        
        
    </div>


            </div>
<div class="jumbotron fortags">
	<div class="d-md-flex h-100">
		<div class="col-md-4 transpdark align-self-center text-center h-100">
			<div class="d-md-flex align-items-center justify-content-center h-100">
				<h2 class="d-md-block d-none align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">â†’</span></h2>
			</div>
		</div>
		<div class="col-md-8 p-5 align-self-center text-center">
			
			<a class="mt-1 mb-1" href="/tags/array">array</a>
			
			<a class="mt-1 mb-1" href="/tags/backtracking">backtracking</a>
			
			<a class="mt-1 mb-1" href="/tags/binary-indexed-tree">binary indexed tree</a>
			
			<a class="mt-1 mb-1" href="/tags/binary-search">binary search</a>
			
			<a class="mt-1 mb-1" href="/tags/binary-search-tree">binary search tree</a>
			
			<a class="mt-1 mb-1" href="/tags/binary-tree">binary tree</a>
			
			<a class="mt-1 mb-1" href="/tags/bit-manipulation">bit manipulation</a>
			
			<a class="mt-1 mb-1" href="/tags/bitmask">bitmask</a>
			
			<a class="mt-1 mb-1" href="/tags/brainteaser">brainteaser</a>
			
			<a class="mt-1 mb-1" href="/tags/breadth-first-search">breadth-first search</a>
			
			<a class="mt-1 mb-1" href="/tags/bucket-sort">bucket sort</a>
			
			<a class="mt-1 mb-1" href="/tags/combinatorics">combinatorics</a>
			
			<a class="mt-1 mb-1" href="/tags/concurrency">concurrency</a>
			
			<a class="mt-1 mb-1" href="/tags/counting">counting</a>
			
			<a class="mt-1 mb-1" href="/tags/counting-sort">counting sort</a>
			
			<a class="mt-1 mb-1" href="/tags/data-stream">data stream</a>
			
			<a class="mt-1 mb-1" href="/tags/database">database</a>
			
			<a class="mt-1 mb-1" href="/tags/depth-first-search">depth-first search</a>
			
			<a class="mt-1 mb-1" href="/tags/design">design</a>
			
			<a class="mt-1 mb-1" href="/tags/divide-and-conquer">divide and conquer</a>
			
			<a class="mt-1 mb-1" href="/tags/doubly-linked-list">doubly-linked list</a>
			
			<a class="mt-1 mb-1" href="/tags/dynamic-programming">dynamic programming</a>
			
			<a class="mt-1 mb-1" href="/tags/enumeration">enumeration</a>
			
			<a class="mt-1 mb-1" href="/tags/game-theory">game theory</a>
			
			<a class="mt-1 mb-1" href="/tags/geometry">geometry</a>
			
			<a class="mt-1 mb-1" href="/tags/graph">graph</a>
			
			<a class="mt-1 mb-1" href="/tags/greedy">greedy</a>
			
			<a class="mt-1 mb-1" href="/tags/hash-function">hash function</a>
			
			<a class="mt-1 mb-1" href="/tags/hash-table">hash table</a>
			
			<a class="mt-1 mb-1" href="/tags/heap-priority-queue">heap (priority queue)</a>
			
			<a class="mt-1 mb-1" href="/tags/interactive">interactive</a>
			
			<a class="mt-1 mb-1" href="/tags/iterator">iterator</a>
			
			<a class="mt-1 mb-1" href="/tags/linked-list">linked list</a>
			
			<a class="mt-1 mb-1" href="/tags/math">math</a>
			
			<a class="mt-1 mb-1" href="/tags/matrix">matrix</a>
			
			<a class="mt-1 mb-1" href="/tags/memoization">memoization</a>
			
			<a class="mt-1 mb-1" href="/tags/minimum-spanning-tree">minimum spanning tree</a>
			
			<a class="mt-1 mb-1" href="/tags/monotonic-queue">monotonic queue</a>
			
			<a class="mt-1 mb-1" href="/tags/monotonic-stack">monotonic stack</a>
			
			<a class="mt-1 mb-1" href="/tags/number-theory">number theory</a>
			
			<a class="mt-1 mb-1" href="/tags/ordered-set">ordered set</a>
			
			<a class="mt-1 mb-1" href="/tags/prefix-sum">prefix sum</a>
			
			<a class="mt-1 mb-1" href="/tags/probability-and-statistics">probability and statistics</a>
			
			<a class="mt-1 mb-1" href="/tags/queue">queue</a>
			
			<a class="mt-1 mb-1" href="/tags/quickselect">quickselect</a>
			
			<a class="mt-1 mb-1" href="/tags/radix-sort">radix sort</a>
			
			<a class="mt-1 mb-1" href="/tags/randomized">randomized</a>
			
			<a class="mt-1 mb-1" href="/tags/recursion">recursion</a>
			
			<a class="mt-1 mb-1" href="/tags/reservoir-sampling">reservoir sampling</a>
			
			<a class="mt-1 mb-1" href="/tags/rolling-hash">rolling hash</a>
			
			<a class="mt-1 mb-1" href="/tags/segment-tree">segment tree</a>
			
			<a class="mt-1 mb-1" href="/tags/shortest-path">shortest path</a>
			
			<a class="mt-1 mb-1" href="/tags/simulation">simulation</a>
			
			<a class="mt-1 mb-1" href="/tags/sliding-window">sliding window</a>
			
			<a class="mt-1 mb-1" href="/tags/sorting">sorting</a>
			
			<a class="mt-1 mb-1" href="/tags/stack">stack</a>
			
			<a class="mt-1 mb-1" href="/tags/string">string</a>
			
			<a class="mt-1 mb-1" href="/tags/string-matching">string matching</a>
			
			<a class="mt-1 mb-1" href="/tags/topological-sort">topological sort</a>
			
			<a class="mt-1 mb-1" href="/tags/tree">tree</a>
			
			<a class="mt-1 mb-1" href="/tags/trie">trie</a>
			
			<a class="mt-1 mb-1" href="/tags/two-pointers">two pointers</a>
			
			<a class="mt-1 mb-1" href="/tags/union-find">union find</a>
			
		</div>
	</div>
</div>

<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">    
                <a target="_blank" rel="noopener" href="https://www.wowthemes.net">Mediumish Theme</a> by WowThemes.net
            </div>
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
