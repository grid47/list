<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 1146: Snapshot Array | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 1146: Snapshot Array">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 1146: Snapshot Array in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/leetcode-1146-snapshot-array/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 1146: Snapshot Array">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 1146: Snapshot Array in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-07-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Array">
    <meta property="article:tag" content="Hash Table">
    <meta property="article:tag" content="Binary Search">
    <meta property="article:tag" content="Design">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.ced6b291f6520a092efe4c87ca4fc7047e1c3174b10653f78e13ca06f0bb6abf.css" integrity="sha256-ztaykfZSCgku/kyHyk/HBH4cMXSxBlP3jhPKBvC7ar8=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
	<link rel="stylesheet" href="/css/head.css" integrity="" crossorigin="anonymous" media="screen">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="main-content">

<div class="container">
	<div class="row">
        <div class="col-md-1"></div>
		<div class="col-md-10">
			<div class="mainheading">
				<h1 class="posttitle">Leetcode 1146: Snapshot Array</h1> 
            </div>
			<div class="article-post">
				<hr>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode85s0hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">SnapshotArray</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    unordered_map<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, map<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, <span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;</span> snaps;
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> snap_id <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    SnapshotArray(<span style="color:#0b0;font-weight:bold">int</span> length) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> length; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            map<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, <span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> mp;
</span></span><span style="display:flex;"><span>            mp[<span style="color:#666">0</span>] <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>            snaps[i] <span style="color:#666">=</span> mp;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">set</span>(<span style="color:#0b0;font-weight:bold">int</span> index, <span style="color:#0b0;font-weight:bold">int</span> val) {
</span></span><span style="display:flex;"><span>        snaps[index][snap_id] <span style="color:#666">=</span> val;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">snap</span>() {
</span></span><span style="display:flex;"><span>        snap_id<span style="color:#666">++</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> snap_id <span style="color:#666">-</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">get</span>(<span style="color:#0b0;font-weight:bold">int</span> index, <span style="color:#0b0;font-weight:bold">int</span> snid) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">auto</span> it <span style="color:#666">=</span> snaps[index].upper_bound(snid);
</span></span><span style="display:flex;"><span>        it<span style="color:#666">--</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> it<span style="color:#666">-&gt;</span>second;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * Your SnapshotArray object will be instantiated and called as such:
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * SnapshotArray* obj = new SnapshotArray(length);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * obj-&gt;set(index,val);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * int param_2 = obj-&gt;snap();
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * int param_3 = obj-&gt;get(index,snap_id);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> */</span></span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement</h3>
<p>The &ldquo;Snapshot Array&rdquo; problem involves creating a data structure that allows you to efficiently store and retrieve snapshots of an array at various points in time. This data structure should support the following operations:</p>
<ol>
<li><strong>set(index, val)</strong>: Sets the value of an element at a given index in the array.</li>
<li><strong>snap()</strong>: Takes a snapshot of the array and returns a unique <code>snap_id</code>.</li>
<li><strong>get(index, snap_id)</strong>: Retrieves the value of the element at the specified index from the snapshot with the given <code>snap_id</code>.</li>
</ol>
<p>The objective is to create a data structure that can handle multiple snapshots efficiently without the need to store each version of the entire array.</p>
<h3 id="approach">Approach</h3>
<p>This implementation of <code>SnapshotArray</code> uses a hash map combined with a nested ordered map to efficiently handle the snapshots:</p>
<ol>
<li><strong>Outer Hash Map</strong> (<code>unordered_map&lt;int, map&lt;int, int&gt;&gt; snaps</code>): Maps each index in the array to a time-sorted map (<code>map&lt;int, int&gt;</code>), which stores the values of that index across different snapshots.</li>
<li><strong>Inner Ordered Map</strong> (<code>map&lt;int, int&gt;</code>): Stores the snapshot IDs as keys and the corresponding values at that index as values. Using an ordered map ensures that we can efficiently find the most recent snapshot value for a given <code>snap_id</code>.</li>
</ol>
<p>The structure of this data structure allows for fast retrieval of values for specific snapshots without duplicating the entire array at each snapshot. Each index only stores the updates it has received, making the approach both memory- and time-efficient.</p>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step)</h3>
<p>Hereâ€™s a step-by-step breakdown of the code:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">SnapshotArray</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    unordered_map<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, map<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, <span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;</span> snaps;
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> snap_id <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span></code></pre></div><ul>
<li><strong>Lines 1-4</strong>: The <code>SnapshotArray</code> class is defined. The variable <code>snaps</code> is an <code>unordered_map</code> where each key represents an index in the array, and the value is an ordered <code>map</code> that tracks snapshot IDs and values for that index. <code>snap_id</code> keeps track of the current snapshot ID, starting at 0.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    SnapshotArray(<span style="color:#0b0;font-weight:bold">int</span> length) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> length; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            map<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span>, <span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> mp;
</span></span><span style="display:flex;"><span>            mp[<span style="color:#666">0</span>] <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>            snaps[i] <span style="color:#666">=</span> mp;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><ul>
<li><strong>Lines 5-10</strong>: The constructor initializes the array. For each index, an ordered map is created with an initial snapshot ID of <code>0</code> and a value of <code>0</code>. This ensures that every index starts with a default value of <code>0</code> in snapshot <code>0</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">set</span>(<span style="color:#0b0;font-weight:bold">int</span> index, <span style="color:#0b0;font-weight:bold">int</span> val) {
</span></span><span style="display:flex;"><span>        snaps[index][snap_id] <span style="color:#666">=</span> val;
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><ul>
<li><strong>Lines 11-13</strong>: The <code>set</code> method updates the value at a specified <code>index</code> in the array. It assigns the value <code>val</code> for the current <code>snap_id</code>, indicating that <code>index</code> should have this value in the current snapshot.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">snap</span>() {
</span></span><span style="display:flex;"><span>        snap_id<span style="color:#666">++</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> snap_id <span style="color:#666">-</span> <span style="color:#666">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><ul>
<li><strong>Lines 14-17</strong>: The <code>snap</code> method increments the <code>snap_id</code> to create a new snapshot, then returns the previous <code>snap_id</code> as the ID of the snapshot that was just taken.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">get</span>(<span style="color:#0b0;font-weight:bold">int</span> index, <span style="color:#0b0;font-weight:bold">int</span> snid) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">auto</span> it <span style="color:#666">=</span> snaps[index].upper_bound(snid);
</span></span><span style="display:flex;"><span>        it<span style="color:#666">--</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> it<span style="color:#666">-&gt;</span>second;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ul>
<li><strong>Lines 18-22</strong>: The <code>get</code> method retrieves the value at <code>index</code> for a specified <code>snap_id</code> (<code>snid</code>). Using <code>upper_bound</code>, it locates the smallest snapshot ID greater than <code>snid</code>. The iterator is decremented (<code>it--</code>) to access the snapshot at or before <code>snid</code>. The retrieved value, <code>it-&gt;second</code>, represents the value at <code>index</code> for <code>snid</code>.</li>
</ul>
<h3 id="complexity">Complexity</h3>
<ul>
<li>
<p><strong>Time Complexity</strong>:</p>
<ul>
<li><strong>set</strong>: ( O(\log S) ), where ( S ) is the number of snapshots taken for a specific index, because of insertion into an ordered map.</li>
<li><strong>snap</strong>: ( O(1) ), since it only increments the snapshot ID.</li>
<li><strong>get</strong>: ( O(\log S) ), where ( S ) is the number of snapshots at the given index. The <code>upper_bound</code> operation takes ( O(\log S) ).</li>
</ul>
</li>
<li>
<p><strong>Space Complexity</strong>: ( O(n + k) ), where ( n ) is the number of indices and ( k ) is the total number of updates across snapshots. This space complexity accounts for the storage of only modified values for each index.</p>
</li>
</ul>
<h3 id="conclusion">Conclusion</h3>
<p>This C++ implementation of the <code>SnapshotArray</code> class offers an efficient way to store and retrieve array states across snapshots. By using a hash map of ordered maps, the solution ensures fast retrieval for specific snapshots without duplicating the array at each snapshot. The design is optimal for scenarios requiring frequent snapshots and updates to individual elements, making it a powerful solution for managing time-versioned data in applications like undo functionality, version control, or real-time state tracking.</p>
<p><a href="https://leetcode.com/problems/snapshot-array/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>
<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

			</div>
		</div>
        <div class="col-md-1"></div>
	</div>
</div>

</div>


            </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
