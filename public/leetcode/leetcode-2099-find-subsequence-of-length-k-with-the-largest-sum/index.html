<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 2099: Find Subsequence of Length K With the Largest Sum | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 2099: Find Subsequence of Length K With the Largest Sum">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 2099: Find Subsequence of Length K With the Largest Sum in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/leetcode-2099-find-subsequence-of-length-k-with-the-largest-sum/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 2099: Find Subsequence of Length K With the Largest Sum">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 2099: Find Subsequence of Length K With the Largest Sum in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-04-11T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Array">
    <meta property="article:tag" content="Hash Table">
    <meta property="article:tag" content="Sorting">
    <meta property="article:tag" content="Heap (Priority Queue)">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.ced6b291f6520a092efe4c87ca4fc7047e1c3174b10653f78e13ca06f0bb6abf.css" integrity="sha256-ztaykfZSCgku/kyHyk/HBH4cMXSxBlP3jhPKBvC7ar8=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
	<link rel="stylesheet" href="/css/head.css" integrity="" crossorigin="anonymous" media="screen">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="main-content">

<div class="container">
	<div class="row">
        <div class="col-md-1"></div>
		<div class="col-md-10">
			<div class="mainheading">
				<h1 class="posttitle">Leetcode 2099: Find Subsequence of Length K With the Largest Sum</h1> 
            </div>
			<div class="article-post">
				<hr>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode557s0hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">Solution</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> maxSubsequence(vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&amp;</span> nums, <span style="color:#0b0;font-weight:bold">int</span> k) {
</span></span><span style="display:flex;"><span>        vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> v(nums.begin(), nums.end());
</span></span><span style="display:flex;"><span>        nth_element(v.begin(), v.begin() <span style="color:#666">+</span> k <span style="color:#666">-</span> <span style="color:#666">1</span>, v.end(), greater<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span>());
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> cnt <span style="color:#666">=</span> count(v.begin(), v.begin() <span style="color:#666">+</span> k, v[k <span style="color:#666">-</span> <span style="color:#666">1</span>]);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> res;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> nums.size(); i<span style="color:#666">++</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>((nums[i] <span style="color:#666">&gt;</span> v[k <span style="color:#666">-</span> <span style="color:#666">1</span>]) <span style="color:#666">||</span>
</span></span><span style="display:flex;"><span>               (nums[i] <span style="color:#666">==</span> v[k <span style="color:#666">-</span> <span style="color:#666">1</span>] <span style="color:#666">&amp;&amp;</span> (cnt<span style="color:#666">--</span> <span style="color:#666">&gt;</span> <span style="color:#666">0</span>)))
</span></span><span style="display:flex;"><span>                res.push_back(nums[i]);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> res;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};</span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement</h3>
<p>The task is to find a subsequence of length <code>k</code> from an integer array <code>nums</code> that has the highest possible sum. A subsequence is a sequence that can be derived from the array by deleting some or no elements without changing the order of the remaining elements. The output should maintain the relative order of the elements in <code>nums</code>.</p>
<h3 id="approach">Approach</h3>
<p>To solve this problem efficiently, we can leverage the following approach:</p>
<ol>
<li>
<p><strong>Clone and Partially Sort the Array</strong>: To find the <code>k</code> largest elements, we start by creating a copy of the <code>nums</code> array. This allows us to work with the values without modifying the original arrayâ€™s structure.</p>
</li>
<li>
<p><strong>Use <code>nth_element</code> for Efficient Partial Sorting</strong>: We use <code>nth_element</code> on the copied array to ensure that the <code>k</code> largest elements are positioned in the first <code>k</code> places, sorted in descending order. The function <code>nth_element</code> achieves this with average-case O(n) complexity. This helps us quickly find the k largest elements without fully sorting the array, which would take O(n log n) time.</p>
</li>
<li>
<p><strong>Handle Duplicates Carefully</strong>: The <code>nth_element</code> function sorts the <code>k</code> largest elements but may include duplicate values around the boundary between the k-th and (k+1)-th elements. We handle this by counting the number of times the k-th largest value appears within the selected range.</p>
</li>
<li>
<p><strong>Collect the Elements in Original Order</strong>: After identifying the <code>k</code> largest values, we iterate through the original array to select elements for the final result. For each element in <code>nums</code>:</p>
<ul>
<li>If it is larger than the k-th largest value in our partial array, it is included in the result.</li>
<li>If it equals the k-th largest value and the count has not been fully used, we also include it.</li>
</ul>
</li>
<li>
<p><strong>Return the Result</strong>: The result array is built in the same order as <code>nums</code>, containing the <code>k</code> largest elements with maximum sum and correct relative order.</p>
</li>
</ol>
<p>This approach is optimal for efficiently finding and arranging the desired subsequence while maintaining the necessary order.</p>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step)</h3>
<p>Letâ€™s walk through the code to see how each part works in detail.</p>
<ol>
<li>
<p><strong>Clone and Partially Sort the Array</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> v(nums.begin(), nums.end());
</span></span><span style="display:flex;"><span>nth_element(v.begin(), v.begin() <span style="color:#666">+</span> k <span style="color:#666">-</span> <span style="color:#666">1</span>, v.end(), greater<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span>());
</span></span></code></pre></div><ul>
<li>Here, we create a copy of <code>nums</code> called <code>v</code> to hold the elements that we want to partially sort.</li>
<li>Using <code>nth_element</code>, we position the <code>k</code> largest elements at the beginning of <code>v</code>, with <code>v[k - 1]</code> representing the k-th largest value. The <code>greater&lt;int&gt;()</code> comparator ensures that the elements are arranged in descending order for the first <code>k</code> elements.</li>
</ul>
</li>
<li>
<p><strong>Count Occurrences of the k-th Largest Value</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> cnt <span style="color:#666">=</span> count(v.begin(), v.begin() <span style="color:#666">+</span> k, v[k <span style="color:#666">-</span> <span style="color:#666">1</span>]);
</span></span></code></pre></div><ul>
<li>Here, we count how many times the k-th largest value (<code>v[k - 1]</code>) appears in the first <code>k</code> elements of <code>v</code>. This is necessary to manage duplicates correctly when we later select elements from <code>nums</code>.</li>
</ul>
</li>
<li>
<p><strong>Collect Elements in the Original Order</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> res;
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> nums.size(); i<span style="color:#666">++</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">if</span>((nums[i] <span style="color:#666">&gt;</span> v[k <span style="color:#666">-</span> <span style="color:#666">1</span>]) <span style="color:#666">||</span> (nums[i] <span style="color:#666">==</span> v[k <span style="color:#666">-</span> <span style="color:#666">1</span>] <span style="color:#666">&amp;&amp;</span> (cnt<span style="color:#666">--</span> <span style="color:#666">&gt;</span> <span style="color:#666">0</span>)))
</span></span><span style="display:flex;"><span>        res.push_back(nums[i]);
</span></span></code></pre></div><ul>
<li>We initialize an empty vector <code>res</code> to store the final result.</li>
<li>We iterate over <code>nums</code>, checking each element to see if it should be included in <code>res</code>:
<ul>
<li>If <code>nums[i]</code> is greater than the k-th largest value, it is included in <code>res</code>.</li>
<li>If <code>nums[i]</code> equals the k-th largest value, we include it only if our <code>cnt</code> variable indicates that we still need this value (by checking if <code>cnt-- &gt; 0</code>).</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Return the Result</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">return</span> res;
</span></span></code></pre></div><ul>
<li>After collecting the required elements in the correct order, we return <code>res</code>, which now contains the <code>k</code> largest elements with maximum sum from <code>nums</code>, maintaining their original order.</li>
</ul>
</li>
</ol>
<h3 id="complexity">Complexity</h3>
<ul>
<li><strong>Time Complexity</strong>: The algorithm has an average time complexity of O(n), where <code>n</code> is the number of elements in <code>nums</code>. This is due to the <code>nth_element</code> function, which operates in O(n) on average. The subsequent loop to collect the result has O(n) complexity as well.</li>
<li><strong>Space Complexity</strong>: The algorithm uses O(n) additional space, as we create a copy of <code>nums</code> and store the result in <code>res</code>.</li>
</ul>
<h3 id="conclusion">Conclusion</h3>
<p>This solution leverages efficient sorting techniques and a careful selection process to find a subsequence with maximum sum in optimal time. The use of <code>nth_element</code> allows us to quickly obtain the <code>k</code> largest elements without fully sorting the array, and the counting mechanism ensures that duplicates are handled accurately. This approach highlights the importance of balancing efficiency and correctness in algorithm design, especially in competitive programming and interview settings where both optimal time complexity and precise output are essential.</p>
<p><a href="https://leetcode.com/problems/find-subsequence-of-length-k-with-the-largest-sum/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/QXvaOym_Awk?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

			</div>
		</div>
        <div class="col-md-1"></div>
	</div>
</div>

</div>


            </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
