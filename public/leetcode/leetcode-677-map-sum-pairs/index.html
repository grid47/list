<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 677: Map Sum Pairs | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 677: Map Sum Pairs">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 677: Map Sum Pairs in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/leetcode-677-map-sum-pairs/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 677: Map Sum Pairs">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 677: Map Sum Pairs in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-08-31T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Hash Table">
    <meta property="article:tag" content="String">
    <meta property="article:tag" content="Design">
    <meta property="article:tag" content="Trie">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.ced6b291f6520a092efe4c87ca4fc7047e1c3174b10653f78e13ca06f0bb6abf.css" integrity="sha256-ztaykfZSCgku/kyHyk/HBH4cMXSxBlP3jhPKBvC7ar8=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
	<link rel="stylesheet" href="/css/head.css" integrity="" crossorigin="anonymous" media="screen">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="main-content">

<div class="container">
	<div class="row">
        <div class="col-md-1"></div>
		<div class="col-md-10">
			<div class="mainheading">
				<h1 class="posttitle">Leetcode 677: Map Sum Pairs</h1> 
            </div>
			<div class="article-post">
				<h2 id="hahahugoshortcode1250s0hbhb"><figure class="remote-image" style="text-align:center; margin: 0;">
    <div style="position: relative; width:900px; max-width:100%; padding-bottom:56.25%; overflow: hidden; border-radius:0px;">
      <img src="https://raw.githubusercontent.com/grid47/list-images/refs/heads/main/list/677.webp" 
           alt="A map where sum pairs are found and highlighted with glowing connections." 
           style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;">
    </div>
    
      <figcaption style="font-size: 0.8em; font-weight: 300; color:#555; margin-top: 4px; line-height: 1.2;">
        Solution to LeetCode 677: Map Sum Pairs Problem
      </figcaption>
    
  </figure>
  </h2>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode1250s1hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">TrieNode</span> {
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span>TrieNode<span style="color:#666">*&gt;</span> next;
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> sum <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    string s;
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    TrieNode() {
</span></span><span style="display:flex;"><span>        s <span style="color:#666">=</span> <span style="color:#b44">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>        sum <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>        next.resize(<span style="color:#666">26</span>, <span style="color:#a2f">NULL</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">add</span>(string key, <span style="color:#0b0;font-weight:bold">int</span> val) {
</span></span><span style="display:flex;"><span>        TrieNode<span style="color:#666">*</span> root <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">this</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> key.size(); i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#0b0;font-weight:bold">int</span> idx <span style="color:#666">=</span> key[i] <span style="color:#666">-</span> <span style="color:#b44">&#39;a&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(root<span style="color:#666">-&gt;</span>next[idx] <span style="color:#666">==</span> <span style="color:#a2f">NULL</span>)
</span></span><span style="display:flex;"><span>                root<span style="color:#666">-&gt;</span>next[idx] <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> TrieNode();
</span></span><span style="display:flex;"><span>            root <span style="color:#666">=</span> root<span style="color:#666">-&gt;</span>next[idx];
</span></span><span style="display:flex;"><span>            root<span style="color:#666">-&gt;</span>sum <span style="color:#666">+=</span> val;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        root<span style="color:#666">-&gt;</span>s <span style="color:#666">=</span> key;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">val</span>(string key) {
</span></span><span style="display:flex;"><span>        TrieNode<span style="color:#666">*</span> root <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">this</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> key.size(); i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#0b0;font-weight:bold">int</span> idx <span style="color:#666">=</span> key[i] <span style="color:#666">-</span> <span style="color:#b44">&#39;a&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(root<span style="color:#666">-&gt;</span>next[idx] <span style="color:#666">==</span> <span style="color:#a2f">NULL</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#a2f;font-weight:bold">return</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>            root <span style="color:#666">=</span> root<span style="color:#666">-&gt;</span>next[idx];
</span></span><span style="display:flex;"><span>        }        
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> root<span style="color:#666">-&gt;</span>sum;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">MapSum</span> {
</span></span><span style="display:flex;"><span>    TrieNode<span style="color:#666">*</span> root;
</span></span><span style="display:flex;"><span>    map<span style="color:#666">&lt;</span>string, <span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> store;
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    MapSum() {
</span></span><span style="display:flex;"><span>        root <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> TrieNode();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">insert</span>(string key, <span style="color:#0b0;font-weight:bold">int</span> val) {
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> x <span style="color:#666">=</span> val;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span>(store[key] <span style="color:#666">&gt;</span> <span style="color:#666">0</span>)
</span></span><span style="display:flex;"><span>            val <span style="color:#666">=</span> val <span style="color:#666">-</span> store[key];
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        root<span style="color:#666">-&gt;</span>add(key, val);
</span></span><span style="display:flex;"><span>        store[key] <span style="color:#666">=</span> x;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">sum</span>(string prefix) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> root<span style="color:#666">-&gt;</span>val(prefix);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * Your MapSum object will be instantiated and called as such:
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * MapSum* obj = new MapSum();
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * obj-&gt;insert(key,val);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> * int param_2 = obj-&gt;sum(prefix);
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"> */</span></span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement:</h3>
<p>The problem involves implementing a class <code>MapSum</code> which supports two operations efficiently:</p>
<ol>
<li><strong><code>insert(key, value)</code></strong>: Inserts a key-value pair into the map. If the key already exists, the new value should replace the old one.</li>
<li><strong><code>sum(prefix)</code></strong>: Returns the sum of all values associated with keys that start with the given prefix.</li>
</ol>
<p>The challenge is to provide a solution where both operations are handled in an efficient manner, especially when dealing with large numbers of keys.</p>
<h3 id="approach">Approach:</h3>
<p>To solve this problem efficiently, we need to handle both operations—insert and sum—optimally. A good approach is to use a <strong>Trie (prefix tree)</strong> to store the keys and their associated values. The trie will allow efficient insertion and prefix-based sum calculation. Here&rsquo;s the detailed approach:</p>
<ol>
<li>
<p><strong>Trie Data Structure</strong>:</p>
<ul>
<li>A <strong>Trie</strong> is a tree-like data structure where each node represents a character in a word. The structure enables fast retrieval of words with common prefixes and allows for efficient insertions.</li>
<li>Each node in the Trie will store:
<ul>
<li>A list of child nodes for each character (26 children, one for each lowercase letter).</li>
<li>A <code>sum</code> field that tracks the sum of all values associated with the keys that pass through or end at this node.</li>
<li>A string <code>s</code> to keep track of the word associated with the node, which is useful to avoid redundant inserts in case a key is modified.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Insert Operation</strong>:</p>
<ul>
<li>For each key-value pair, insert the key into the Trie character by character. For each character of the key, if the node corresponding to that character does not exist, create a new node. As you traverse the trie, update the <code>sum</code> field of each node to reflect the running sum of values for keys that pass through that node.</li>
</ul>
</li>
<li>
<p><strong>Sum Operation</strong>:</p>
<ul>
<li>For a given prefix, simply traverse the trie following the characters of the prefix. Once the traversal is complete, the <code>sum</code> field of the last node will contain the sum of values for all keys that share this prefix.</li>
</ul>
</li>
<li>
<p><strong>Handling Updates (Replacement)</strong>:</p>
<ul>
<li>If a key already exists, subtract the old value from all nodes along its path in the trie and then add the new value. This ensures that the map is updated correctly without needing a full re-insertion.</li>
</ul>
</li>
</ol>
<p>By using a Trie, we can achieve efficient insertions and prefix sum calculations, both of which are critical for solving the problem within time limits.</p>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step):</h3>
<h4 id="step-1-trienode-class">Step 1: <code>TrieNode</code> Class</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">TrieNode</span> {
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span>TrieNode<span style="color:#666">*&gt;</span> next;
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> sum <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    string s;
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    TrieNode() {
</span></span><span style="display:flex;"><span>        s <span style="color:#666">=</span> <span style="color:#b44">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>        sum <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>        next.resize(<span style="color:#666">26</span>, <span style="color:#a2f">NULL</span>);  <span style="color:#080;font-style:italic">// Initialize the next vector for 26 characters (a-z)
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">add</span>(string key, <span style="color:#0b0;font-weight:bold">int</span> val) {
</span></span><span style="display:flex;"><span>        TrieNode<span style="color:#666">*</span> root <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">this</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> key.size(); i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#0b0;font-weight:bold">int</span> idx <span style="color:#666">=</span> key[i] <span style="color:#666">-</span> <span style="color:#b44">&#39;a&#39;</span>;  <span style="color:#080;font-style:italic">// Convert char to index (0 for &#39;a&#39;, 1 for &#39;b&#39;, etc.)
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>            <span style="color:#a2f;font-weight:bold">if</span> (root<span style="color:#666">-&gt;</span>next[idx] <span style="color:#666">==</span> <span style="color:#a2f">NULL</span>)
</span></span><span style="display:flex;"><span>                root<span style="color:#666">-&gt;</span>next[idx] <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> TrieNode();  <span style="color:#080;font-style:italic">// Create a new node if it doesn&#39;t exist
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>            root <span style="color:#666">=</span> root<span style="color:#666">-&gt;</span>next[idx];  <span style="color:#080;font-style:italic">// Move to the next node
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>            root<span style="color:#666">-&gt;</span>sum <span style="color:#666">+=</span> val;  <span style="color:#080;font-style:italic">// Update the sum for the current node
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>        }
</span></span><span style="display:flex;"><span>        root<span style="color:#666">-&gt;</span>s <span style="color:#666">=</span> key;  <span style="color:#080;font-style:italic">// Store the key in the leaf node
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">val</span>(string key) {
</span></span><span style="display:flex;"><span>        TrieNode<span style="color:#666">*</span> root <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">this</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> key.size(); i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#0b0;font-weight:bold">int</span> idx <span style="color:#666">=</span> key[i] <span style="color:#666">-</span> <span style="color:#b44">&#39;a&#39;</span>;  <span style="color:#080;font-style:italic">// Convert char to index
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>            <span style="color:#a2f;font-weight:bold">if</span> (root<span style="color:#666">-&gt;</span>next[idx] <span style="color:#666">==</span> <span style="color:#a2f">NULL</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#a2f;font-weight:bold">return</span> <span style="color:#666">0</span>;  <span style="color:#080;font-style:italic">// Return 0 if no prefix is found
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>            root <span style="color:#666">=</span> root<span style="color:#666">-&gt;</span>next[idx];  <span style="color:#080;font-style:italic">// Move to the next node
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> root<span style="color:#666">-&gt;</span>sum;  <span style="color:#080;font-style:italic">// Return the sum at the node corresponding to the prefix
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>    }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ul>
<li>The <code>TrieNode</code> class represents each node in the Trie.</li>
<li>It contains a vector of 26 pointers (<code>next</code>), representing child nodes for each letter of the alphabet.</li>
<li>The <code>sum</code> field tracks the sum of values for all keys that pass through or end at this node.</li>
<li>The <code>add</code> method inserts a key into the Trie, updating the <code>sum</code> values along the path.</li>
<li>The <code>val</code> method calculates the sum of values for all keys starting with the given prefix.</li>
</ul>
<h4 id="step-2-mapsum-class">Step 2: <code>MapSum</code> Class</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">MapSum</span> {
</span></span><span style="display:flex;"><span>    TrieNode<span style="color:#666">*</span> root;
</span></span><span style="display:flex;"><span>    map<span style="color:#666">&lt;</span>string, <span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> store;  <span style="color:#080;font-style:italic">// Stores key-value pairs to track value updates
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    MapSum() {
</span></span><span style="display:flex;"><span>        root <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> TrieNode();  <span style="color:#080;font-style:italic">// Initialize the root of the Trie
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">insert</span>(string key, <span style="color:#0b0;font-weight:bold">int</span> val) {
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> x <span style="color:#666">=</span> val;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span> (store[key] <span style="color:#666">&gt;</span> <span style="color:#666">0</span>)
</span></span><span style="display:flex;"><span>            val <span style="color:#666">=</span> val <span style="color:#666">-</span> store[key];  <span style="color:#080;font-style:italic">// Subtract the old value to ensure correct sum
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>        root<span style="color:#666">-&gt;</span>add(key, val);  <span style="color:#080;font-style:italic">// Add the key with the new value to the Trie
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>        store[key] <span style="color:#666">=</span> x;  <span style="color:#080;font-style:italic">// Store the new value in the map
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">sum</span>(string prefix) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> root<span style="color:#666">-&gt;</span>val(prefix);  <span style="color:#080;font-style:italic">// Return the sum of values for the given prefix
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>    }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ul>
<li>The <code>MapSum</code> class manages the Trie (<code>root</code>) and a map (<code>store</code>) that tracks the most recent value for each key.</li>
<li>The <code>insert</code> method handles inserting a new key-value pair, updating the Trie and the map. If the key already exists, the old value is subtracted before adding the new value to ensure correctness.</li>
<li>The <code>sum</code> method calculates the sum of all values for keys that begin with the given prefix by querying the Trie.</li>
</ul>
<h4 id="example-usage">Example Usage:</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>MapSum<span style="color:#666">*</span> obj <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> MapSum();
</span></span><span style="display:flex;"><span>obj<span style="color:#666">-&gt;</span>insert(<span style="color:#b44">&#34;apple&#34;</span>, <span style="color:#666">3</span>);  <span style="color:#080;font-style:italic">// Insert key &#34;apple&#34; with value 3
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#0b0;font-weight:bold">int</span> sum1 <span style="color:#666">=</span> obj<span style="color:#666">-&gt;</span>sum(<span style="color:#b44">&#34;ap&#34;</span>);  <span style="color:#080;font-style:italic">// Query the sum of values for keys starting with &#34;ap&#34; (should return 3)
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>obj<span style="color:#666">-&gt;</span>insert(<span style="color:#b44">&#34;apple&#34;</span>, <span style="color:#666">2</span>);  <span style="color:#080;font-style:italic">// Update key &#34;apple&#34; with value 2
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#0b0;font-weight:bold">int</span> sum2 <span style="color:#666">=</span> obj<span style="color:#666">-&gt;</span>sum(<span style="color:#b44">&#34;ap&#34;</span>);  <span style="color:#080;font-style:italic">// Query the sum again after the update (should return 2)
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>obj<span style="color:#666">-&gt;</span>insert(<span style="color:#b44">&#34;app&#34;</span>, <span style="color:#666">5</span>);  <span style="color:#080;font-style:italic">// Insert key &#34;app&#34; with value 5
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#0b0;font-weight:bold">int</span> sum3 <span style="color:#666">=</span> obj<span style="color:#666">-&gt;</span>sum(<span style="color:#b44">&#34;ap&#34;</span>);  <span style="color:#080;font-style:italic">// Query the sum (should return 7)
</span></span></span></code></pre></div><h3 id="complexity">Complexity:</h3>
<h4 id="time-complexity">Time Complexity:</h4>
<ul>
<li><strong><code>insert(key, value)</code></strong>: The time complexity is <code>O(L)</code> where <code>L</code> is the length of the key. This is because we traverse each character of the key once to insert it into the Trie and update the sums.</li>
<li><strong><code>sum(prefix)</code></strong>: The time complexity is <code>O(L)</code> where <code>L</code> is the length of the prefix. We only need to traverse the nodes corresponding to the prefix to get the sum.</li>
</ul>
<h4 id="space-complexity">Space Complexity:</h4>
<ul>
<li><strong><code>O(N * L)</code></strong> where <code>N</code> is the number of keys and <code>L</code> is the average length of the keys. Each key potentially adds <code>L</code> nodes to the Trie, and the map stores <code>N</code> key-value pairs.</li>
</ul>
<h3 id="conclusion">Conclusion:</h3>
<p>The solution efficiently handles the <code>insert</code> and <code>sum</code> operations using a Trie data structure. By using the Trie to store prefixes and associated sums, we achieve fast lookups for prefix-based sum queries. The addition of the <code>store</code> map ensures that we correctly handle key updates by adjusting the Trie sums when values change. This approach provides optimal time and space complexity for the given problem, making it suitable for large datasets.</p>
<p><a href="https://leetcode.com/problems/map-sum-pairs/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/GwiKly7UJbQ?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

			</div>
		</div>
        <div class="col-md-1"></div>
	</div>
</div>

</div>


            </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
