<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 957: Prison Cells After N Days | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 957: Prison Cells After N Days">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 957: Prison Cells After N Days in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/leetcode-957-prison-cells-after-n-days/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 957: Prison Cells After N Days">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 957: Prison Cells After N Days in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-08-03T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Array">
    <meta property="article:tag" content="Hash Table">
    <meta property="article:tag" content="Math">
    <meta property="article:tag" content="Bit Manipulation">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.ced6b291f6520a092efe4c87ca4fc7047e1c3174b10653f78e13ca06f0bb6abf.css" integrity="sha256-ztaykfZSCgku/kyHyk/HBH4cMXSxBlP3jhPKBvC7ar8=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
	<link rel="stylesheet" href="/css/head.css" integrity="" crossorigin="anonymous" media="screen">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="main-content">

<div class="container">
	<div class="row">
        <div class="col-md-1"></div>
		<div class="col-md-10">
			<div class="mainheading">
				<h1 class="posttitle">Leetcode 957: Prison Cells After N Days</h1> 
            </div>
			<div class="article-post">
				<hr>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode1414s0hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">Solution</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> prisonAfterNDays(vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&amp;</span> cells, <span style="color:#0b0;font-weight:bold">int</span> n) {
</span></span><span style="display:flex;"><span>        set<span style="color:#666">&lt;</span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;</span> seen;
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>, flag <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>        vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> c;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> n; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> v <span style="color:#666">=</span> getNext(cells);
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(<span style="color:#666">!</span>seen.count(v)) {
</span></span><span style="display:flex;"><span>                seen.insert(v);
</span></span><span style="display:flex;"><span>                cells <span style="color:#666">=</span> v;
</span></span><span style="display:flex;"><span>            } <span style="color:#a2f;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> j <span style="color:#666">=</span> <span style="color:#666">0</span>; j <span style="color:#666">&lt;</span> n <span style="color:#666">%</span> i; j<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>                    cells <span style="color:#666">=</span> getNext(cells);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#a2f;font-weight:bold">return</span> cells;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> cells;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> getNext(vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> <span style="color:#666">&amp;</span>cells) {
</span></span><span style="display:flex;"><span>        vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> n(cells.size(), <span style="color:#666">0</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">1</span>; i <span style="color:#666">&lt;</span> cells.size() <span style="color:#666">-</span><span style="color:#666">1</span>; i<span style="color:#666">++</span>)
</span></span><span style="display:flex;"><span>            n[i] <span style="color:#666">=</span> cells[i<span style="color:#666">-</span><span style="color:#666">1</span>] <span style="color:#666">==</span> cells[i<span style="color:#666">+</span><span style="color:#666">1</span>]<span style="color:#666">?</span><span style="color:#666">1</span><span style="color:#666">:</span><span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> n;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};</span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement</h3>
<p>In this problem, we are tasked with simulating a prison cell system for <code>n</code> days. Each prison cell can either be open or closed. Initially, the state of each cell is given in the form of a binary vector <code>cells</code>. After each day, the state of each cell changes based on the following rules:</p>
<ol>
<li>A cell becomes open (represented by 1) if both of its neighbors are in the same state (either both open or both closed).</li>
<li>A cell becomes closed (represented by 0) otherwise (i.e., if the neighbors are in different states).</li>
</ol>
<p>The challenge is to determine the state of the prison cells after <code>n</code> days. However, since the transformation could repeat in cycles after a certain number of days, the problem asks for an optimized solution to handle cases where <code>n</code> is large.</p>
<h3 id="approach">Approach</h3>
<p>To solve the problem efficiently, we need to avoid simulating all <code>n</code> days directly. Since the sequence of prison cell configurations may repeat periodically, we can leverage this periodicity to minimize the number of steps we need to take.</p>
<p>The solution follows these main steps:</p>
<ol>
<li>
<p><strong>Cycle Detection</strong>: Instead of simulating all <code>n</code> days, we detect cycles in the transformations. If a configuration repeats, we know the cycle has started over. Once a cycle is detected, we can skip the unnecessary steps by reducing the problem to just a few days (the remainder when <code>n</code> is divided by the cycle length).</p>
</li>
<li>
<p><strong>Simulating the Transition</strong>: We simulate the transition of the cells for each day. A helper function <code>getNext</code> is used to calculate the state of the next day based on the current state of the cells. This function checks each cell&rsquo;s neighbors and updates its state accordingly.</p>
</li>
<li>
<p><strong>Efficient Calculation</strong>: The solution uses a set to store previously seen configurations of cells. If a configuration repeats, we can break out of the loop and handle the remaining days by taking advantage of the cycle length.</p>
</li>
</ol>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step)</h3>
<ol>
<li>
<p><strong>Initialization</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>set<span style="color:#666">&lt;</span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;&gt;</span> seen;
</span></span><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">0</span>, flag <span style="color:#666">=</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> c;
</span></span></code></pre></div><ul>
<li>A <code>set</code> called <code>seen</code> is used to store unique configurations of the prison cells. A set is chosen because it allows fast membership checks and ensures that we only store unique configurations.</li>
<li>The variable <code>i</code> is used to iterate through the days, and <code>flag</code> is a placeholder to control the cycle detection logic.</li>
<li><code>vector&lt;int&gt; c</code> is used as a temporary storage to hold the current configuration of cells.</li>
</ul>
</li>
<li>
<p><strong>Simulating the Days</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">for</span>(i <span style="color:#666">=</span> <span style="color:#666">0</span>; i <span style="color:#666">&lt;</span> n; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> v <span style="color:#666">=</span> getNext(cells);
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">if</span>(<span style="color:#666">!</span>seen.count(v)) {
</span></span><span style="display:flex;"><span>        seen.insert(v);
</span></span><span style="display:flex;"><span>        cells <span style="color:#666">=</span> v;
</span></span><span style="display:flex;"><span>    } <span style="color:#a2f;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> j <span style="color:#666">=</span> <span style="color:#666">0</span>; j <span style="color:#666">&lt;</span> n <span style="color:#666">%</span> i; j<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            cells <span style="color:#666">=</span> getNext(cells);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> cells;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">return</span> cells;
</span></span></code></pre></div><ul>
<li>The loop iterates over <code>n</code> days. In each iteration:
<ul>
<li>The <code>getNext</code> function is called to compute the state of the cells for the next day.</li>
<li>If the configuration of cells <code>v</code> has not been seen before, it is inserted into the <code>seen</code> set, and <code>cells</code> is updated to the new configuration.</li>
<li>If the configuration has been seen before (i.e., a cycle is detected), the loop exits. To handle the remaining days efficiently, the program calculates how many days are left to simulate using <code>n % i</code>. This allows the program to skip over repeated cycles and directly compute the final state of the cells.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Transition Function (getNext)</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> getNext(vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> <span style="color:#666">&amp;</span>cells) {
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> n(cells.size(), <span style="color:#666">0</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">1</span>; i <span style="color:#666">&lt;</span> cells.size() <span style="color:#666">-</span> <span style="color:#666">1</span>; i<span style="color:#666">++</span>)
</span></span><span style="display:flex;"><span>        n[i] <span style="color:#666">=</span> cells[i<span style="color:#666">-</span><span style="color:#666">1</span>] <span style="color:#666">==</span> cells[i<span style="color:#666">+</span><span style="color:#666">1</span>] <span style="color:#666">?</span> <span style="color:#666">1</span> <span style="color:#666">:</span> <span style="color:#666">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">return</span> n;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>This function computes the next configuration of the cells based on the rules.</li>
<li>A new vector <code>n</code> is created to store the next state of the cells. Initially, all cells in <code>n</code> are set to 0.</li>
<li>The loop goes through each cell (except the first and last ones, since they have no neighbors on both sides). For each cell, it checks if its two neighbors have the same state (either both open or both closed). If they do, the cell in the next configuration is set to 1 (open); otherwise, it is set to 0 (closed).</li>
<li>The function returns the new configuration <code>n</code>.</li>
</ul>
</li>
<li>
<p><strong>Cycle Detection</strong>:</p>
<ul>
<li>The key optimization in this solution is the use of a set to track previously seen configurations of the cells. If a configuration is encountered more than once, we know that the system has started repeating itself, and we can calculate how many remaining steps need to be simulated using the modulus of the cycle length.</li>
</ul>
</li>
</ol>
<h3 id="complexity">Complexity</h3>
<ol>
<li>
<p><strong>Time Complexity</strong>:</p>
<ul>
<li>The time complexity of the solution depends on the number of unique cell configurations and the number of steps required to simulate the prison system.</li>
<li>In the worst case, the number of unique configurations is bounded by the number of possible combinations of the 8 cells, which is <code>2^8 = 256</code> (since each cell can either be open or closed). Therefore, we can detect cycles after at most 256 steps.</li>
<li>The total time complexity is <code>O(min(n, C))</code>, where <code>C</code> is the number of unique configurations (256 in this case). Each step involves computing the next state, which is <code>O(k)</code>, where <code>k</code> is the number of cells (fixed at 8).</li>
</ul>
</li>
<li>
<p><strong>Space Complexity</strong>:</p>
<ul>
<li>The space complexity is dominated by the <code>set</code> used to store the unique configurations of the cells. In the worst case, we store all possible configurations, which is <code>O(256)</code>.</li>
</ul>
</li>
</ol>
<h3 id="conclusion">Conclusion</h3>
<p>The solution efficiently simulates the prison cell system by detecting cycles in the transformations of the cells. By using a set to store previously seen configurations, we avoid unnecessary computations for repeated states, significantly reducing the number of steps required when <code>n</code> is large. This approach allows us to handle even large values of <code>n</code> while ensuring that the program runs efficiently. The solution leverages cycle detection to optimize the simulation and guarantees that the final state of the prison cells is computed in an optimal time complexity.</p>
<p><a href="https://leetcode.com/problems/prison-cells-after-n-days/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/mQQp6I985bw?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

			</div>
		</div>
        <div class="col-md-1"></div>
	</div>
</div>

</div>


            </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
