<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.136.4">
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Leetcode 2523: Closest Prime Numbers in Range | grid47</title>
	
	

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leetcode 2523: Closest Prime Numbers in Range">
  <meta name="twitter:description" content="In-depth solution and explanation for Leetcode 2523: Closest Prime Numbers in Range in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">

	<meta property="og:url" content="http://localhost:1313/leetcode/leetcode-2523-closest-prime-numbers-in-range/">
  <meta property="og:site_name" content="grid47">
  <meta property="og:title" content="Leetcode 2523: Closest Prime Numbers in Range">
  <meta property="og:description" content="In-depth solution and explanation for Leetcode 2523: Closest Prime Numbers in Range in C&#43;&#43;. Includes clear intuition, step-by-step example walkthrough, and detailed complexity analysis.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="leetcode">
    <meta property="article:published_time" content="2024-02-28T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-06T00:00:00+00:00">
    <meta property="article:tag" content="Math">
    <meta property="article:tag" content="Number Theory">


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="http://localhost:1313/css/medium.ced6b291f6520a092efe4c87ca4fc7047e1c3174b10653f78e13ca06f0bb6abf.css" integrity="sha256-ztaykfZSCgku/kyHyk/HBH4cMXSxBlP3jhPKBvC7ar8=">

	
	<link rel="stylesheet" href="http://localhost:1313/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
	<link rel="stylesheet" href="/css/head.css" integrity="" crossorigin="anonymous" media="screen">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost:1313//">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/leetcode/">LeetCode</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/terms/">Terms &amp; Policy</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="main-content">

<div class="container">
	<div class="row">
        <div class="col-md-1"></div>
		<div class="col-md-10">
			<div class="mainheading">
				<h1 class="posttitle">Leetcode 2523: Closest Prime Numbers in Range</h1> 
            </div>
			<div class="article-post">
				<hr>
<p><strong>Code:</strong></p>
<h2 id="hahahugoshortcode811s0hbhb"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">Solution</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">bool</span> seive[<span style="color:#666">1000001</span>] <span style="color:#666">=</span> {};
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> p <span style="color:#666">=</span> {<span style="color:#666">2</span>};
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> closestPrimes(<span style="color:#0b0;font-weight:bold">int</span> left, <span style="color:#0b0;font-weight:bold">int</span> right) {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">3</span>; i <span style="color:#666">&lt;</span> <span style="color:#666">1000001</span>; i <span style="color:#666">+=</span> <span style="color:#666">2</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(<span style="color:#666">!</span>seive[i]) {
</span></span><span style="display:flex;"><span>                p.push_back(i);
</span></span><span style="display:flex;"><span>                <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">long</span> <span style="color:#0b0;font-weight:bold">long</span> j <span style="color:#666">=</span> (<span style="color:#0b0;font-weight:bold">long</span> <span style="color:#0b0;font-weight:bold">long</span>) i <span style="color:#666">*</span> i; j <span style="color:#666">&lt;</span> <span style="color:#666">1000001</span>; j <span style="color:#666">+=</span> i) {
</span></span><span style="display:flex;"><span>                    seive[j] <span style="color:#666">=</span> <span style="color:#a2f">true</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#0b0;font-weight:bold">int</span> n1 <span style="color:#666">=</span> <span style="color:#666">-</span><span style="color:#666">1</span>, n2 <span style="color:#666">=</span> <span style="color:#666">-</span><span style="color:#666">1</span>, i <span style="color:#666">=</span> lower_bound(p.begin(), p.end(), left) <span style="color:#666">-</span> p.begin();
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">for</span>(; i <span style="color:#666">+</span> <span style="color:#666">1</span> <span style="color:#666">&lt;</span> p.size() <span style="color:#666">&amp;&amp;</span> p[i <span style="color:#666">+</span> <span style="color:#666">1</span>] <span style="color:#666">&lt;=</span> right; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(n1 <span style="color:#666">==</span> <span style="color:#666">-</span><span style="color:#666">1</span> <span style="color:#666">||</span> n2 <span style="color:#666">-</span> n1 <span style="color:#666">&gt;</span> p[i <span style="color:#666">+</span> <span style="color:#666">1</span>] <span style="color:#666">-</span> p[i]) {
</span></span><span style="display:flex;"><span>                n1 <span style="color:#666">=</span> p[i];
</span></span><span style="display:flex;"><span>                n2 <span style="color:#666">=</span> p[i <span style="color:#666">+</span> <span style="color:#666">1</span>];
</span></span><span style="display:flex;"><span>                <span style="color:#a2f;font-weight:bold">if</span>(n2 <span style="color:#666">-</span> n1 <span style="color:#666">&lt;</span> <span style="color:#666">3</span>) <span style="color:#a2f;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">return</span> {n1, n2};
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};</span></span></code></pre></div></h2>
<h3 id="problem-statement">Problem Statement</h3>
<p>The task is to find the closest pair of prime numbers in a given range <code>[left, right]</code> where the difference between the primes is at least 2 but as small as possible. If no such pair exists, the function should return <code>[-1, -1]</code>. The given range is inclusive of both <code>left</code> and <code>right</code>.</p>
<h3 id="approach">Approach</h3>
<p>To solve this problem, the algorithm can be divided into the following steps:</p>
<ol>
<li>
<p><strong>Sieve of Eratosthenes</strong>:
We will first use the <strong>Sieve of Eratosthenes</strong> to generate all prime numbers up to <code>1,000,000</code>. This sieve will help us identify all the primes efficiently.</p>
</li>
<li>
<p><strong>Prime Number Collection</strong>:
After marking all the primes using the sieve, we store the prime numbers in a vector for quick access.</p>
</li>
<li>
<p><strong>Finding the Closest Primes</strong>:
The algorithm then proceeds to find the closest primes in the given range <code>[left, right]</code>. We do this by:</p>
<ul>
<li>Searching for the smallest prime number that is greater than or equal to <code>left</code>.</li>
<li>Then, checking the next prime to see if it is less than or equal to <code>right</code>.</li>
<li>Keeping track of the smallest difference between consecutive primes in the range.</li>
</ul>
</li>
<li>
<p><strong>Edge Case Handling</strong>:
If there are no two primes found within the given range that satisfy the condition (i.e., the difference is at least 2), we return <code>[-1, -1]</code>.</p>
</li>
</ol>
<h3 id="code-breakdown-step-by-step">Code Breakdown (Step by Step)</h3>
<h4 id="class-definition-and-member-variables">Class Definition and Member Variables:</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">Solution</span> {
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">bool</span> seive[<span style="color:#666">1000001</span>] <span style="color:#666">=</span> {};
</span></span><span style="display:flex;"><span>    vector<span style="color:#666">&lt;</span><span style="color:#0b0;font-weight:bold">int</span><span style="color:#666">&gt;</span> p <span style="color:#666">=</span> {<span style="color:#666">2</span>};
</span></span></code></pre></div><ul>
<li>The <code>seive</code> array is used to mark non-prime numbers. It is initialized with <code>false</code> to represent all numbers as prime initially.</li>
<li>The <code>p</code> vector stores the prime numbers. The prime <code>2</code> is added initially because <code>2</code> is the smallest prime number.</li>
</ul>
<h4 id="sieve-of-eratosthenes">Sieve of Eratosthenes:</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">for</span>(<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> <span style="color:#666">3</span>; i <span style="color:#666">&lt;</span> <span style="color:#666">1000001</span>; i <span style="color:#666">+=</span> <span style="color:#666">2</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span>(<span style="color:#666">!</span>seive[i]) {
</span></span><span style="display:flex;"><span>            p.push_back(i);
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">for</span> (<span style="color:#0b0;font-weight:bold">long</span> <span style="color:#0b0;font-weight:bold">long</span> j <span style="color:#666">=</span> (<span style="color:#0b0;font-weight:bold">long</span> <span style="color:#0b0;font-weight:bold">long</span>) i <span style="color:#666">*</span> i; j <span style="color:#666">&lt;</span> <span style="color:#666">1000001</span>; j <span style="color:#666">+=</span> i) {
</span></span><span style="display:flex;"><span>                seive[j] <span style="color:#666">=</span> <span style="color:#a2f">true</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><ul>
<li>The loop iterates through all numbers starting from <code>3</code> up to <code>1,000,000</code>. It only checks odd numbers (<code>i += 2</code>), since even numbers greater than <code>2</code> are not prime.</li>
<li>For each number <code>i</code> that is still marked as prime (i.e., <code>seive[i] == false</code>), it adds <code>i</code> to the list of primes <code>p</code>.</li>
<li>The inner loop marks all multiples of <code>i</code> as non-prime (i.e., it marks all <code>j = i * i, i * i + i, ...</code> as <code>true</code> in the <code>seive</code> array).</li>
</ul>
<h4 id="finding-the-closest-primes">Finding the Closest Primes:</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#0b0;font-weight:bold">int</span> n1 <span style="color:#666">=</span> <span style="color:#666">-</span><span style="color:#666">1</span>, n2 <span style="color:#666">=</span> <span style="color:#666">-</span><span style="color:#666">1</span>, i <span style="color:#666">=</span> lower_bound(p.begin(), p.end(), left) <span style="color:#666">-</span> p.begin();
</span></span></code></pre></div><ul>
<li><code>n1</code> and <code>n2</code> are initialized to <code>-1</code>, representing the closest primes found so far.</li>
<li>The variable <code>i</code> is initialized to the index of the first prime number in the <code>p</code> vector that is greater than or equal to <code>left</code>. This is done using the <code>lower_bound</code> function, which efficiently finds the index of the first element that is not less than <code>left</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">for</span>(; i <span style="color:#666">+</span> <span style="color:#666">1</span> <span style="color:#666">&lt;</span> p.size() <span style="color:#666">&amp;&amp;</span> p[i <span style="color:#666">+</span> <span style="color:#666">1</span>] <span style="color:#666">&lt;=</span> right; i<span style="color:#666">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span>(n1 <span style="color:#666">==</span> <span style="color:#666">-</span><span style="color:#666">1</span> <span style="color:#666">||</span> n2 <span style="color:#666">-</span> n1 <span style="color:#666">&gt;</span> p[i <span style="color:#666">+</span> <span style="color:#666">1</span>] <span style="color:#666">-</span> p[i]) {
</span></span><span style="display:flex;"><span>            n1 <span style="color:#666">=</span> p[i];
</span></span><span style="display:flex;"><span>            n2 <span style="color:#666">=</span> p[i <span style="color:#666">+</span> <span style="color:#666">1</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#a2f;font-weight:bold">if</span>(n2 <span style="color:#666">-</span> n1 <span style="color:#666">&lt;</span> <span style="color:#666">3</span>) <span style="color:#a2f;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><ul>
<li>The loop iterates through the prime numbers in the <code>p</code> vector starting from index <code>i</code> and checks for consecutive primes <code>p[i]</code> and <code>p[i + 1]</code>.</li>
<li>If the difference between the two primes is smaller than the previous closest pair, it updates <code>n1</code> and <code>n2</code> to store the current closest primes.</li>
<li>If the difference between the primes is less than <code>3</code>, the loop breaks, as we are only interested in pairs of primes with a difference of at least 2.</li>
</ul>
<h4 id="return-the-result">Return the Result:</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">return</span> {n1, n2};
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>After the loop, the closest pair of primes <code>n1</code> and <code>n2</code> is returned. If no such pair was found, <code>n1</code> and <code>n2</code> will remain <code>-1</code>, and the function will return <code>[-1, -1]</code>.</li>
</ul>
<h3 id="time-complexity">Time Complexity:</h3>
<ol>
<li>
<p><strong>Sieve of Eratosthenes</strong>:</p>
<ul>
<li>The sieve runs in ( O(n \log(\log(n))) ) time, where <code>n = 1,000,000</code>. This is because the sieve algorithm involves iterating over all numbers up to <code>n</code>, and for each prime <code>i</code>, it marks all of its multiples as non-prime.</li>
<li>The sieve is efficient and works in nearly linear time with respect to the size of the range, making it feasible for <code>n = 1,000,000</code>.</li>
</ul>
</li>
<li>
<p><strong>Prime Search Using Binary Search</strong>:</p>
<ul>
<li>After generating the list of primes, we use <code>lower_bound</code> to find the first prime greater than or equal to <code>left</code>. The <code>lower_bound</code> operation runs in ( O(\log(p)) ), where <code>p</code> is the number of primes found up to <code>1,000,000</code>. Since there are approximately <code>78,498</code> primes up to <code>1,000,000</code>, this operation runs in logarithmic time with respect to the number of primes.</li>
<li>The subsequent loop also runs in ( O(p) ), where <code>p</code> is the number of primes in the range <code>[left, right]</code>. This loop checks each pair of consecutive primes in the range, making it linear in terms of the number of primes between <code>left</code> and <code>right</code>.</li>
</ul>
</li>
<li>
<p><strong>Overall Time Complexity</strong>:</p>
<ul>
<li>The total time complexity is dominated by the sieve, which is ( O(n \log(\log(n))) ), and the prime search using binary search, which is ( O(p) ), where <code>n = 1,000,000</code> and <code>p</code> is the number of primes between <code>left</code> and <code>right</code>. Thus, the overall complexity is ( O(n \log(\log(n))) ), which is efficient for the input limits.</li>
</ul>
</li>
</ol>
<h3 id="space-complexity">Space Complexity:</h3>
<ul>
<li>The space complexity is primarily determined by the space used to store the sieve array and the list of primes.</li>
<li>The sieve array takes ( O(n) ) space, where <code>n = 1,000,000</code>.</li>
<li>The list of primes <code>p</code> takes ( O(p) ) space, where <code>p</code> is the number of primes up to <code>1,000,000</code>. This is approximately <code>78,498</code>.</li>
<li>Therefore, the total space complexity is ( O(n) ), which is ( O(1,000,000) ).</li>
</ul>
<h3 id="conclusion">Conclusion</h3>
<p>This solution efficiently solves the problem of finding the closest pair of primes in a given range <code>[left, right]</code> using the <strong>Sieve of Eratosthenes</strong> to precompute the primes up to <code>1,000,000</code>. The solution uses a combination of binary search (<code>lower_bound</code>) and linear iteration through primes to find the closest pair of primes within the range. The approach is optimal with respect to both time and space complexity, handling the constraints effectively.</p>
<p><a href="https://leetcode.com/problems/closest-prime-numbers-in-range/description/"><code>Link to LeetCode Lab</code></a></p>
<hr>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/HqSBI1RVM8c?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<table>
  <thead>
      <tr>
          <th><a href="https://grid47.xyz/leetcode/">LeetCode Solutions Library</a> / <a href="https://grid47.xyz/sheets/">DSA Sheets</a> / <a href="https://grid47.xyz/courses/">Course Catalog</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

			</div>
		</div>
        <div class="col-md-1"></div>
	</div>
</div>

</div>


            </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright www.grid47.com - All rights reserved
            </div>
            
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1LN7R4LHR1"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1LN7R4LHR1');
        }
      </script>
    </body>
</html>
